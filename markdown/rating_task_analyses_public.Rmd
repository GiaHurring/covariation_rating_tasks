---
title: "Social perceptions of segmental covariation in New Zealand English"
subtitle: "Supplementary material"
author:
  - Gia Hurring
date: "2025-06-16"
output:
  bookdown::html_document2:
    fig_caption: true
    toc: true
    toc_float: true
    theme: flatly
    collapsed: no
    df_print: paged
    code_folding: show
editor_options: 
  markdown: 
    wrap: 72
---

```{=html}
<style>
.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    background-color: #95A044;
}

pre {
  max-height: 300px;
  overflow-y: 300px;
}
</style>
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# **Introduction**

This markdown contains the analyses for two pre-registered social
perception experiments (<https://aspredicted.org/xhc6-pm8k.pdf>).
Briefly, these two experiments explored how New Zealand English (NZE)
listeners use individual features or patterns of features to perceive
social meaning. These features included either two vowel variables (KIT
and TRAP) or a vowel and consonant variable (TRAP and intervocalic
medial /t/). The KIT and TRAP variables were explored in an experiment
called the 'vowels-only' experiment while the TRAP and /t/ variables
were explored in a 'vowel-and-t' experiment. Both experiments used a
binary forced choice design and a slider design (where participants were
assigned to one design or the other for the entire listening task).

The hypotheses for these experiments were motivated by production
analyses that explored covariation patterns between vowel and non-vowel
variables in NZE speakers. Refer to the pre-registration for more
information about these hypotheses.

This document first presents the results for the vowels-only experiment
(exp1) before turning to the results of the vowel-and-t experiment
(exp2). The data we load in has already been restructured and filtered.
This process is currently being kept private as it contains identifying
information about the participants (such as email addresses and IP
addresses). The filtering process followed the same steps outlined in
the pre-registration document, which are, in brief:

-   For the scale task, listeners 2.5SD away from the mean SD.

-   For the binary task, listeners who answer the same responses more
    than 90% of the time.

-   Participants who answered less than 6/8 correct for the 'automated'
    stimuli. This is to catch any bot responses that the online
    experiment may get.

-   Listeners reporting hearing difficulty (part of the post-task
    questionnaire).

-   Listeners who did not acquire English in NZ before the age of 7.

-   Listeners who answer incorrectly to the following post-questionnaire
    questions:

\- What is the name of New Zealand's newest public holiday?

\- What language is the New Zealand national anthem sung in?

Additional filtering included looking at participant metadata to find
spam/bot responses.

If you wish to run this code yourself, I recommend cloning the GitHub
repository and running the code using the `.Rproj` file to load the
entire project.

## Libraries

```{r}
library(tidyverse)
library(dplyr)
library(here)
library(jsonlite)
library(listviewer)
library(purrr)
library(magrittr)
library(arsenal)
library(lme4)
library(effects)
library(ggplot2)
library(patchwork)
library(remotes)
library(ggrepel)
#install_version("marginaleffects", "0.19.0")
library(marginaleffects)
packageVersion("marginaleffects") #should be version 0.19.0

# We set a seed here. This will only give the same models if you run each
# code block sequentially (rather than interactively running code blocks)
set.seed(114)
```

# **Vowels-only experiment**

First, let's load in the tidy data which we will use to analyse the
results, plus data specific to the participants themselves (which is
used for post hoc analysis).

```{r}
exp1_data_binary_final <- read.csv(here("data", "exp1_data_binary_final.csv"))
exp1_data_slider_final <- read.csv(here("data", "exp1_data_slider_final.csv"))
exp1_participant_data_information <- read.csv(here("data", "exp1_participant_data_information.csv"))
```

Let's look at the demographic information of the participants.

```{r}
exp1_participant_data_information <- exp1_participant_data_information %>%
  mutate(qGender = fct_recode(factor(qGender),
                            "woman" = "F",
                            "woman" = "female",
                            "woman" = "Female",
                            "woman" = "Woman",
                            "man" = "male",
                            "man" = "Male",
                            "nonbinary" = "non-binary",
                            "nonbinary" = "Non-binary"))
         
# how many participants?
exp1_participant_data_information_unique <- exp1_participant_data_information %>%
  select(1, 8, 11) %>%
  unique() #96 participants

exp1_binary_information_unique <- exp1_participant_data_information %>%
  filter(response == "forced-choice") %>%
  select(1, 8, 11) %>%
  unique() #51 binary participants

exp1_slider_information_unique <- exp1_participant_data_information %>%
  filter(response == "slider") %>%
  select(1, 8, 11) %>%
  unique() #45 slider participants

# checking the demographics
table(exp1_participant_data_information_unique$qAge)
table(exp1_binary_information_unique$qAge)
table(exp1_slider_information_unique$qAge)

table(exp1_participant_data_information_unique$qGender) 
table(exp1_binary_information_unique$qGender) 
table(exp1_slider_information_unique$qGender) 

table(exp1_participant_data_information_unique$qGender, exp1_participant_data_information_unique$qAge)
table(exp1_binary_information_unique$qGender, exp1_binary_information_unique$qAge)
table(exp1_slider_information_unique$qGender, exp1_slider_information_unique$qAge)

rm(exp1_participant_data_information_unique, 
   exp1_binary_information_unique,
   exp1_slider_information_unique)

```

## Hypotheses

We'll use the `marginaleffects` package for our hypothesis testing. Here
is our predictions for the vowels-only experiment.

Here is the guide for the hypothesis:

-   KK = word-pairs with two KIT vowels (e.g., *big pig*)

-   TT = word-pairs with two TRAP vowels (e.g., *bad dad*)

-   i = innovative (ii = two innovative vowels)

-   c = conservative (cc = two conservative vowels)

-   VD = the vowels in the word-pair are different (e.g., *big dad, bad
    pig*)

-   VS = the vowels in the word-pair are the same (e.g., *big pig, bad
    dad*)

-   ic = innovative + conservative manipulation

-   ci = conservative + innovative manipulation

[H1: Social meaning in isolation]{.underline}

a)  *KKii \< KKcc* (-ii stimuli will have more younger, less masculine,
    less well educated, and strong NZ accent responses (lower estimate
    mean) than -cc stimuli for KK word-pairs).

b)  *TTii \< TTcc* (-ii stimuli will have more younger, less masculine,
    less well educated, and strong NZ accent responses (lower estimate
    mean) than -cc for TT word-pairs).

[H2: Different variables vs repetition of same variables]{.underline}

a)  *VDcc \> VScc* (VD (KT/TK) word-pairs will have more older, more
    masculine, more well educated, and not strong NZ accent responses
    (higher estimate mean) than VS (KK/TT) word-pairs for
    conservative-conservative stimuli).

b)  *VDii \< VSii* (VD (KT/TK) will have more younger, less masculine,
    less well educated, and strong NZ accent responses (lower estimate
    mean) than VS (KK/TT) for matching innovative-innovative stimuli).

[H3: Relative salience of variables]{.underline}

a)  *KKcc != TTcc* (KKcc will not have the same mean responses as TTcc).

b)  *KKii != TTii* (KKii will not have the same mean responses as TTii).

[H4: Order of presentation]{.underline}

a)  *ic \< ci* (in mismatching conditions, an innovative first vowel
    will have more younger, less masculine, less well educated, and
    strong NZ accent responses (lower estimate mean) than conservative
    first vowel stimuli).

For one-sided tests (H1, H2, and H4), we judge significance by the
`p(NonSup)` columns. For the other tests (H3), we judge the significant
of the `Pr(>|z|)` column because we are just seeing if there is a
significant difference between to variables (rather than a significant
difference *from* a variable).

## Binary analysis

We split up the `exp1_data_binary_final` into the four social
dimensions.

```{r}
exp1_data_binary_final_age <- exp1_data_binary_final %>%
  filter(binary_response %in% c("younger", "older"))

exp1_data_binary_final_gender <- exp1_data_binary_final %>%
  filter(binary_response %in% c("less masculine", "more masculine"))

exp1_data_binary_final_education <- exp1_data_binary_final %>%
  filter(binary_response %in% c("less well educated", "more well educated"))

exp1_data_binary_final_accent  <- exp1_data_binary_final %>%
  filter(binary_response %in% c("not strong NZ accent", "strong NZ accent"))
```

Just quickly before we model, let's check the distribution of just some
of this data.

```{r}
exp1_data_binary_final <- exp1_data_binary_final %>%
  mutate(dimension = case_when(
     str_detect(binary_response, "older") ~ "age",
     str_detect(binary_response, "younger") ~ "age",
     str_detect(binary_response, "educated") ~ "education",
     str_detect(binary_response, "NZ") ~ "accent",
     str_detect(binary_response, "masculine") ~ "gender"
  )) 

binary_response_table <- exp1_data_binary_final %>%
  group_by(dimension) %>%
  count(binary_response) %>%
  mutate(percentage = (n/sum(n)*100)) %>%
  rename(count = n,
         percentage = percentage) %>%
  ungroup() %>%
  mutate(dimension = factor(dimension, levels = c("age", "gender", "education", "accent")))

binary_response_table$Rounded = round(binary_response_table$percentage,2)

binary_distribution_plot <- binary_response_table %>%
  ggplot(aes(x=factor(binary_response, level = c('younger', 'older', 'less masculine', 'more masculine', 'less well educated', 'more well educated', 'strong NZ accent', 'not strong NZ accent')), y=percentage, fill=dimension)) + 
  geom_bar(stat = "identity") +
  geom_text(aes(label=Rounded),vjust = -0.25)+
  #guides(fill="none") +
  xlab("Forced-choice response to all social dimensions") +
  ylab("Percentage of responses") +
  scale_x_discrete(guide = guide_axis(angle = 45))

binary_distribution_plot

```

Let's get it more specific

```{r}
binary_response_table2 <- exp1_data_binary_final %>%
  group_by(dimension, v_types_shorthand) %>%
  count(binary_response) %>%
  mutate(percentage = (n/sum(n)*100)) %>%
  rename(count = n,
         percentage = percentage) %>%
  ungroup() 

binary_response_table2$Rounded = round(binary_response_table2$percentage,2)

binary_response_table2$binary_response <- factor(binary_response_table2$binary_response, levels=c('not strong NZ accent', 'strong NZ accent',  'older','younger', 'less well educated', 'more well educated', 'less masculine', 'more masculine'))

binary_distribution_plot2 <- binary_response_table2 %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  #guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage of responses") +
  #scale_x_discrete(guide = guide_axis(angle = 45)) +
  facet_wrap(~dimension) +
  scale_fill_manual(values=c("darkorange1", "royalblue1", "tomato2", "limegreen", "purple2", "goldenrod1", "salmon1", "lightseagreen"))

binary_distribution_plot2

binary_response_table2$dimension <- factor(binary_response_table2$dimension, levels=c('age', 'gender', 'education', 'accent'))
binary_response_table2$binary_response <- factor(binary_response_table2$binary_response, levels=c('older','younger', 'less masculine', 'more masculine', 'less well educated', 'more well educated', 'not strong NZ accent', 'strong NZ accent'))

binary_distribution_plot3 <- binary_response_table2 %>%
  filter(binary_response %in% c('younger', 'less masculine', 'less well educated', 'strong NZ accent')) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  guides(fill=guide_legend(title="Binary response")) +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("Percentage of 'innovative' predicted binary responses for exp1") +
  geom_segment(aes(x = 1, y = 65, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  facet_wrap(~dimension)

binary_distribution_plot3

```

I like the third plot most - let's save it!

```{r}
binary_response_table_by_vowel <- exp1_data_binary_final %>%
  group_by(dimension, v_types_shorthand, vs) %>%
  count(binary_response) %>%
  mutate(percentage = (n/sum(n)*100)) %>%
  rename(count = n,
         percentage = percentage) %>%
  ungroup() 

binary_distribution_plot_TRAP <- binary_response_table_by_vowel %>%
  filter(binary_response %in% c('younger', 'less masculine', 'less well educated', 'strong NZ accent')) %>%
  filter(vs=="TRAPTRAP") %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  guides(fill=guide_legend(title="Binary response")) +
  xlab("Manipulation pair") +
  ylab("Percentage (TT word pairs)") +
  ggtitle("Percentage of 'innovative' predicted binary responses to TT stimuli for exp1") +
  geom_segment(aes(x = 1, y = 65, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray()+
  facet_wrap(~dimension)

binary_distribution_plot_KIT <- binary_response_table_by_vowel %>%
  filter(binary_response %in% c('younger', 'less masculine', 'less well educated', 'strong NZ accent')) %>%
  filter(vs=="KITKIT") %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  guides(fill=guide_legend(title="Binary response")) +
  xlab("Manipulation pair") +
  ylab("Percentage (KK word pairs)") +
  ggtitle("Percentage of 'innovative' predicted binary responses to KK stimuli for exp1") +
  geom_segment(aes(x = 1, y = 65, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray()+
  facet_wrap(~dimension)

binary_distribution_plot_KIT
binary_distribution_plot_TRAP

```

```{r, eval=FALSE}
ggsave(plot = binary_distribution_plot3, here("plots", "vowels_only", "exp1_binary_distribution_plot_predictions.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = binary_distribution_plot_KIT, here("plots", "vowels_only", "exp1_binary_distribution_plot_KITKIT.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = binary_distribution_plot_TRAP, here("plots", "vowels_only", "exp1_binary_distribution_plot_TRAPTRAP.png"), width = 9, height = 6, dpi = 400)
```

### Age model

```{r}
binary_model_age <- glmer(
  binary_response_numeric ~ vowel_same * manipulation_matching * v1_type * vowel_1 + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  family = binomial,
  data = exp1_data_binary_final_age,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)) #does not converge without optimisation control
)
```

```{r}
summary(binary_model_age)
```

#### Hypothesis testing

**H1: Social meaning in isolation**

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  binary_model_age,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP")
  ),
  re.form = NA
)
```

Row 1 tells us that KKii \> KKcc is not statistically significant (i.e.,
`p (NonSup)` (0.863))

Row 2 tells us that TTii \> TTcc is not statistically significant (i.e.,
`p (NonSup)` (0.523))

**H2: Different variables vs repetition of same variables**

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  binary_model_age,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Hypothesis: VDcc \> VScc

Row 1 which looks at conservative conditions is not significant.

Hypothesis: VDii \< VSii

Row 2 which looks at innovative conditions is not significant.

So, listeners are not statistically covarying KIT and TRAP for percepts
of age.

**H3: Relative salience of variables**

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  binary_model_age,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 tells us that TTii \< Kii, which suggests that listeners are more
likely to rate the speaker as *older* for TTii than KKii, and this is
statically significant based on the `Pr(>|z|)` column for our p-value
(\< 0.001).

Row 2 tells us that TTcc \< KKcc, which suggests that listeners are more
likely to rate the speaker as *older* for KKcc than TTcc, and this is
statically significant based on the `Pr(>|z|)` column for our p-value
(0.00649).

No matter what variants of KIT is being heard, listeners are more likely
to rate it as 'older' than TRAP.

**H4: Order of presentation**

a)  ic \< ci

```{r}
comparisons(
  binary_model_age,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Row 1 is significant, meaning there is an order effect here. Listeners
are more likely to rate the speaker as 'younger' if they hear ic stimuli
than ci stimuli.

#### Plots

We plot the binary age data.

```{r}
exp1_data_binary_final_age <- exp1_data_binary_final_age %>% 
  mutate(
    pred_mod2 = predict(binary_model_age, type = "response"),
  )

exp1_data_binary_final_age %>%
  filter(
    manipulation_matching == TRUE
  ) %>% 
  ggplot(
    aes(
      x = vowel_same,
      y = pred_mod2,
      colour = v1_type
    )
  ) +
  geom_boxplot() +
  facet_wrap(~vowel_1)

```

```{r}
exp1_data_binary_final_age %>%
  ggplot(
    aes(
      x = factor(binary_response_numeric),
      fill = interaction(manipulation_matching, vowel_same)
    )
  ) +
  geom_bar() +
  facet_grid(
    rows = vars(vm2),
    cols = vars(vm1),
    labeller = label_both
  ) +
  labs(
    fill = "man, vowel"
  )
```

We plot the relevant model output.

```{r}
plot_comparisons(
  binary_model_age,
  variables = "vowel_same",
  newdata = datagrid(grid_type = "balanced"),
  re.form = NA,
  by = c("v1_type", "manipulation_matching", "vowel_1")
)
```

Because H4 is significant, we can look at this too

```{r}
H4_exp1_binary_age_plot <- comparisons(
  binary_model_age,
  variables = "v1_type",
  newdata = datagrid(
    manipulation_matching = FALSE, 
    vowel_1 = c("KIT", "TRAP"),
    vowel_same = c(TRUE, FALSE)
  ),
  re.form=NA
)

H4_exp1_binary_age_plot %>% 
  mutate(
    vowel_pair = case_when(
      vowel_1 == "KIT" & vowel_same == TRUE ~ "KK",
      vowel_1 == "KIT" & vowel_same == FALSE ~ "KT",
      vowel_1 == "TRAP" & vowel_same == TRUE ~ "TT",
      vowel_1 == "TRAP" & vowel_same == FALSE ~ "TK"
    )
  ) %>%
  ggplot(
    aes(
      x = vowel_pair,
      y = estimate,
      ymin = conf.low,
      ymax = conf.high
    ) 
  ) +
  geom_errorbar() +
  geom_point() +
  labs(y = "(mean)ic - (mean)ci")
```

### Gender model

```{r}
binary_model_gender <- glmer(
  binary_response_numeric ~ vowel_same * manipulation_matching * v1_type * vowel_1 + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  family = binomial,
  data = exp1_data_binary_final_gender,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5))
)
```

```{r}
summary(binary_model_gender)
```

#### Hypothesis testing

**H1: Social meaning in isolation**

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  binary_model_gender,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP")
  ),
  re.form = NA
)
```

Row 1 is not significant (`p (NonSup)` = 0.778).

Row 2 is not significant (`p (NonSup)` = 0.528).

Listeners are not using variants of KIT and TRAP independently for
gender ratings.

**H2: Different variables vs repetition of same variables**

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  binary_model_gender,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Hypothesis: VDcc \> VScc

Row 1 is not significant (0.350)

Hypothesis: VDii \< VSii

Row 2 is not significant (0.945)

Listeners are not patterning KIT and TRAP for gender ratings any more
than variants of KIT or TRAP independently.

**H3: Relative salience of variables**

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  binary_model_gender,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 tells us that TTii \< Kii, which suggests that listeners are more
likely to rate the speaker as *more masculine* for KKii than TTii, and
this is statically significant based on the `Pr(>|z|)` column for our
p-value (\< 0.001)

Row 2 tells us that TTcc \< KKcc, wwhich suggests that listeners are
more likely to rate the speaker as *more masculine* for KKcc than TTcc,
and this is statically significant based on the `Pr(>|z|)` column for
our p-value (\<0.001) (note 'less masculine' is bolded because it is not
our intended prediction).

KIT words are having some sort of gendered effect!

**H4: Order of presentation**

a)  ic \< ci

```{r}
comparisons(
  binary_model_gender,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Row 1 tells us that ic \< ci, which is what we predicted, meaning that
listeners are more likely to rate a speaker as *more masculine*? if they
hear an innovative vowel first. This is indeed the case but is not
statistically significant, based on the `p (NonInf)` value (0.974).

#### Plots

We plot the binary gender data.

```{r}
exp1_data_binary_final_gender <- exp1_data_binary_final_gender %>% 
  mutate(
    pred_mod2 = predict(binary_model_gender, type = "response"),
  )

exp1_data_binary_final_gender %>%
  filter(
    manipulation_matching == TRUE
  ) |> 
  ggplot(
    aes(
      x = vowel_same,
      y = pred_mod2,
      colour = v1_type
    )
  ) +
  geom_boxplot() +
  facet_wrap(~vowel_1)
```

```{r}
exp1_data_binary_final_gender %>%
  ggplot(
    aes(
      x = factor(binary_response_numeric),
      fill = interaction(manipulation_matching, vowel_same)
    )
  ) +
  geom_bar() +
  facet_grid(
    rows = vars(vm2),
    cols = vars(vm1),
    labeller = label_both
  ) +
  labs(
    fill = "man, vowel"
  )
```

We plot the relevant model output.

```{r}
plot_comparisons(
  binary_model_gender,
  variables = "vowel_same",
  newdata = datagrid(grid_type = "balanced"),
  re.form = NA,
  by = c("v1_type", "manipulation_matching", "vowel_1")
)
```

### Education model

```{r}
binary_model_education <- glmer(
  binary_response_numeric ~ vowel_same * manipulation_matching * v1_type * vowel_1 + (1|participant) + (1|word_pair) + (1|stimulus_voice), #need to remove block for singular fit error
  family = binomial,
  data = exp1_data_binary_final_education,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5))
)
```

```{r}
summary(binary_model_education)
```

#### Hypothesis testing

**H1: Social meaning in isolation**

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  binary_model_education,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP")
  ),
  re.form = NA
)
```

Row 1 is significant, meaning that listeners are more likely to rate the
speaker as 'less well educated' for KKii stimuli than KKcc stimuli
(\<0.001).

Row 2 is significant, meaning that listeners are more likely to rate the
speaker as 'less well educated' for TTii stimuli than TTcc stimuk
(\<0.001)

**H2: TDifferent variables vs repetition of same variables**

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  binary_model_education,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Hypothesis: VDcc \> VScc

Row 1 is not significant.

Hypothesis: VDii \< VSii

Row 2 is not significant.

Listeners are not covarying variants of KIT and TRAP for their education
ratings any more than when presented with KIT or TRAP separately.

**H3: Relative salience of variables**

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  binary_model_education,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is not significant.

There is no salience effect going on here (i.e., KIT and TRAP are
equally salient)

**H4: Order of presentation**

a)  ic \< ci

```{r}
comparisons(
  binary_model_education,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Row 1 is not significant, meaning there is no order effect here.

#### Plots

We plot the binary education data.

```{r}
exp1_data_binary_final_education <- exp1_data_binary_final_education %>% 
  mutate(
    pred_mod2 = predict(binary_model_education, type = "response"),
  )

#just the plot of H1
exp1_data_binary_final_education %>%
  filter(
    manipulation_matching == TRUE,
    vowel_same == TRUE
  ) %>% 
  ggplot(
    aes(
      x = v1_type,
      y = pred_mod2,
      colour = v1_type
    )
  ) +
  geom_boxplot() +
  facet_wrap(~vowel_1)

#plot of H1 and H2
exp1_binary_education_H1_H2 <- exp1_data_binary_final_education %>%
  filter(
    manipulation_matching == TRUE
  ) |> 
  ggplot(
    aes(
      x = vowel_same,
      y = pred_mod2,
      colour = v1_type
    )
  ) +
  geom_boxplot() +
  facet_wrap(~vowel_1) +
  ggtitle("Model predictions of H1 and H2 related variables for vowels-only binary education ratings") +
  theme(plot.title = element_text(size = 12)) +
  # KIT facet, FALSE, Conservative
  stat_summary(
    data = . %>% filter(vowel_1 == "KIT" & vowel_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.04,
    position = position_nudge(x = -0.175),
    geom = "text",
    aes(label = "KTcc"),
    color = "black",
    size = 4
  ) +
  # KIT facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(vowel_1 == "KIT" & vowel_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "KTii"),
    color = "black",
    size = 4
  ) +
  # KIT facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(vowel_1 == "KIT" & vowel_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.03,
    position = position_nudge(x = - 0.18),
    geom = "text",
    aes(label = "KKcc"),
    color = "black",
    size = 4
  ) +
  # KIT facet, TRUE, innovative
  stat_summary(
    data = . %>% filter(vowel_1 == "KIT" & vowel_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.005,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "KKii"),
    color = "black",
    size = 4
  ) +
  # TRAP facet. FALSE, conservative
  stat_summary(
    data = . %>% filter(vowel_1 == "TRAP" & vowel_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "TKcc"),
    color = "black",
    size = 4
  ) +
  # TRAP facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(vowel_1 == "TRAP" & vowel_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.03,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "TKii"),
    color = "black",
    size = 4
  ) +
  # TRAP facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(vowel_1 == "TRAP" & vowel_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.035,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "TTcc"),
    color = "black",
    size = 4
  ) +
  # TRAP facet, TRUE, innovative
    stat_summary(
    data = . %>% filter(vowel_1 == "TRAP" & vowel_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.01,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "TTii"),
    color = "black",
    size = 4
  ) +
  xlab("same vowel") +
  ylab("model predictions\n(higher = more well educated)") +
  theme(
    plot.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 13),
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12)
  ) +
  guides(colour = guide_legend(title = "first vowel manipulation")) 

exp1_binary_education_H1_H2

```

We plot the relevant model output.

```{r}
plot_comparisons(
  binary_model_education,
  variables = "vowel_same",
  newdata = datagrid(grid_type = "balanced"),
  re.form = NA,
  by = c("v1_type", "manipulation_matching", "vowel_1")
)
```

Because H1 and H2 are significant, let's save these plots.

```{r, eval=FALSE}
ggsave(plot = exp1_binary_education_H1_H2, here("plots", "vowels_only", "exp1_binary_education_H1_H2.png"), width = 9, height = 6, dpi = 400)
```

### Accent model

```{r}
binary_model_accent <- glmer(
  binary_response_numeric ~ vowel_same * manipulation_matching * v1_type * vowel_1 + (1|participant) + (1|stimulus_voice),
  family = binomial,
  data = exp1_data_binary_final_accent,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)) #removed block (first) and word_pair (second) (both with variance close to 0) to fix singular fit issue
)
```

```{r}
summary(binary_model_accent)
```

#### Hypothesis testing

We predict that 'innovative' vowels will be 'younger','less masculine',
'less educated' *and* 'strong NZ accent' so the hypotheses remain in the
same direction (since both 'younger', 'less masculine','less educated',
and 'strong NZ accent' responses are coded as 0).

**H1: Social meaning in isolation**

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  binary_model_accent,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP")
  ),
  re.form = NA
)
```

Row 1 is significant, meaning that listeners are more likely to rate the
speaker as 'strong NZ accent' when hearing KKii stimuli than KKcc
stimuli (\<0.001)

Row 2 is significant, meaning that listeners are more likely to rate the
speaker as 'strong NZ accent' when hearing TTii stimuli than TTcc
stimuli (\<0.001)

Take home: - both going in the predicted direction, like the education
model.

**H2: Different variables vs repetition of same variables**

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  binary_model_accent,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Hypothesis: VDcc \> VScc

Row 1 is not significant (0.375).

Hypothesis: VDii \< VSii

Row 2 is not significant (0.804).

Listeners are not covarying variants of KIT and TRAP any greater for
their accent ratings than when hearing KIT or TRAP independently.

**H3: Relative salience of variables**

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  binary_model_accent,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is not significant.

KIT and TRAP are equally salient for accent ratings.

**H4: Order of presentation**

a)  ic \< ci

```{r}
comparisons(
  binary_model_accent,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Row 1 is not significant, meaning there is no order effect here.

#### Plots

We plot the binary accent data.

```{r}
exp1_data_binary_final_accent <- exp1_data_binary_final_accent %>% 
  mutate(
    pred_mod2 = predict(binary_model_accent, type = "response"),
  )

#plot of just H1
exp1_data_binary_final_accent %>%
  filter(
    manipulation_matching == TRUE,
    vowel_same == TRUE
  ) %>% 
  ggplot(
    aes(
      x = v1_type,
      y = pred_mod2,
      colour = v1_type
    )
  ) +
  geom_boxplot() +
  facet_wrap(~vowel_1)

#plot of H1 and H2
exp1_binary_accent_H1_H2 <- exp1_data_binary_final_accent %>%
  filter(
    manipulation_matching == TRUE
  ) |> 
  ggplot(
    aes(
      x = vowel_same,
      y = pred_mod2,
      colour = v1_type
    )
  ) +
  geom_boxplot() +
  facet_wrap(~vowel_1) +
  ggtitle("Model predictions of H1 and H2 related variables for vowels-only binary accent ratings") +
  theme(plot.title = element_text(size = 12)) +
  # KIT facet, FALSE, Conservative
  stat_summary(
    data = . %>% filter(vowel_1 == "KIT" & vowel_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.07,
    position = position_nudge(x = -0.175),
    geom = "text",
    aes(label = "KTcc"),
    color = "black",
    size = 4
  ) +
  # KIT facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(vowel_1 == "KIT" & vowel_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.04,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "KTii"),
    color = "black",
    size = 4
  ) +
  # KIT facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(vowel_1 == "KIT" & vowel_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.07,
    position = position_nudge(x = - 0.18),
    geom = "text",
    aes(label = "KKcc"),
    color = "black",
    size = 4
  ) +
  # KIT facet, TRUE, innovative
  stat_summary(
    data = . %>% filter(vowel_1 == "KIT" & vowel_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.035,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "KKii"),
    color = "black",
    size = 4
  ) +
  # TRAP facet. FALSE, conservative
  stat_summary(
    data = . %>% filter(vowel_1 == "TRAP" & vowel_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.07,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "TKcc"),
    color = "black",
    size = 4
  ) +
  # TRAP facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(vowel_1 == "TRAP" & vowel_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.03,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "TKii"),
    color = "black",
    size = 4
  ) +
  # TRAP facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(vowel_1 == "TRAP" & vowel_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.055,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "TTcc"),
    color = "black",
    size = 4
  ) +
  # TRAP facet, TRUE, innovative
    stat_summary(
    data = . %>% filter(vowel_1 == "TRAP" & vowel_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.05,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "TTii"),
    color = "black",
    size = 4
  )  +
  xlab("same vowel") +
  ylab("model predictions\n(higher = not strong NZ accent)") +
  theme(
    plot.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 13),
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12)
  ) +
  guides(colour = guide_legend(title = "first vowel manipulation")) 

exp1_binary_accent_H1_H2
```

We plot the relevant model output.

```{r}
plot_comparisons(
  binary_model_accent,
  variables = "vowel_same",
  newdata = datagrid(grid_type = "balanced"),
  re.form = NA,
  by = c("v1_type", "manipulation_matching", "vowel_1")
)
```

Because H1 and H2 are significant, let's save these plots.

```{r,eval=FALSE}
ggsave(plot = exp1_binary_accent_H1_H2, here("plots", "vowels_only", "exp1_binary_accent_H1_H2.png"), width = 9, height = 6, dpi = 400)
```

## Slider analysis

Now that we have our analysis of the binary forced-choice data, we can
move onto a linear regression model of the slider data.

We split up the `exp1_data_slider_final` into the four social
dimensions.

```{r}
exp1_data_slider_final_age <- exp1_data_slider_final %>%
  filter(grepl(('old'), prompt))

exp1_data_slider_final_gender <- exp1_data_slider_final %>%
  filter(grepl(('masculine'), prompt))

exp1_data_slider_final_education <- exp1_data_slider_final %>%
  filter(grepl(('educated'), prompt))

exp1_data_slider_final_accent <- exp1_data_slider_final %>%
  filter(grepl(('accented'), prompt))

#because accent goes in the opposite direction, we need to inverse the ratings
exp1_data_slider_final_accent <- exp1_data_slider_final_accent %>%
 mutate(slider_response_inverse = 1-(slider_response))

exp1_data_slider_final <- exp1_data_slider_final %>%
  mutate(dimension = case_when(
     str_detect(prompt, "old") ~ "age",
     str_detect(prompt, "educated") ~ "education",
     str_detect(prompt, "accented") ~ "accent",
     str_detect(prompt, "masculine") ~ "gender"
  ))

exp1_data_slider_final$values_for_plotting <- ifelse(
  exp1_data_slider_final$dimension == 'accent',
      1 - exp1_data_slider_final$slider_response,
      exp1_data_slider_final$slider_response)
```

Like the binary data, let's check the distribution of just some of this
data.

```{r}
exp1_slider_distribution <- exp1_data_slider_final %>%
  ggplot(aes(x=factor(dimension, level = c('age', 'gender', 'education', 'accent')), y=slider_response, fill=dimension)) + 
    geom_violin() +
    geom_boxplot(width = 0.3) +
    theme(legend.position="none") +
    xlab("Rating dimension") +
    ylab("Slider responses") +
  ggtitle("Violin distribution of responses to slider task for all social ratings") 

exp1_slider_distribution #this looks pretty even, which is what we want to see :)

exp1_data_slider_final$dimension <- factor(exp1_data_slider_final$dimension, levels=c('age', 'gender', 'education', 'accent'))

# Custom y-axis labels
y_labels <- c("0.0", "0.5", "1.0")

exp1_slider_distribution2 <- exp1_data_slider_final %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot() +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("Boxplots of slider responses for each dimension for exp1") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    facet_wrap(~dimension) +
    theme_gray()

exp1_slider_distribution2 #this looks pretty even, which is what we want to see :)

exp1_data_slider_final %>%
  select(dimension, values_for_plotting, v_types_shorthand) %>%
  group_by(dimension, v_types_shorthand) %>%
  summarise(slider_mean = mean(values_for_plotting))

rm(y_labels)
```

Let's do KIT and TRAP separately

```{r}
# Custom y-axis labels
y_labels <- c("0.0", "0.5", "1.0")

exp1_slider_distribution_TRAP <- exp1_data_slider_final %>%
  filter(vs=="TRAPTRAP") %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot() +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response (TT stimuli)") +
    ggtitle("Boxplots of slider responses to TT stimuli for each dimension for exp1") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    facet_wrap(~dimension) +
    theme_gray()

exp1_slider_distribution_KIT <- exp1_data_slider_final %>%
  filter(vs=="KITKIT") %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot() +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response (KK stimuli)") +
    ggtitle("Boxplots of slider responses to KK stimuli for each dimension for exp1") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    facet_wrap(~dimension) +
    theme_gray()

exp1_slider_distribution_KIT
exp1_slider_distribution_TRAP

```

I like these plots so let's save it!

```{r, eval=FALSE}
ggsave(plot = exp1_slider_distribution2, here("plots", "vowels_only", "exp1_slider_distribution_plot_predictions.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = exp1_slider_distribution_KIT, here("plots", "vowels_only", "exp1_slider_distribution_plot_KITKIT.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = exp1_slider_distribution_TRAP, here("plots", "vowels_only", "exp1_slider_distribution_plot_TRAPTRAP.png"), width = 9, height = 6, dpi = 400)
```

It could also be good to get a sense of the slider variations per
dimension to see how much people were using the slider

```{r}
exp1_data_slider_final %>%
  select(dimension, values_for_plotting) %>%
  group_by(dimension) %>%
  summarise(slider_mean = mean(values_for_plotting),
            slider_variation = sd(values_for_plotting))
```

### Age model

```{r}
slider_model_age <- lmer(
  slider_response ~ vowel_same * manipulation_matching * v1_type * vowel_1 + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp1_data_slider_final_age,
) #removed block for singular fit issue
```

```{r}
summary(slider_model_age)
```

#### Hypothesis testing

**H1: Social meaning in isolation**

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  slider_model_age,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP")
  ),
  re.form = NA
)
```

Row 1 is close to significance but not quite (0.0677)

Row 2 is not significant.

Listeners are not using variants of KIT and TRAP for their age ratings
(although, this is close to significance for KIT)

**H2: Different variables vs repetition of same variables**

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  slider_model_age,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Hypothesis: VDcc \> VScc

Row 1 is not significant.

Hypothesis: VDii \< VSii

Row 2 is not significant.

Listeners are not covarying KIT and TRAP for their age ratings any more
than they do for KIT and TRAP independently.

**H3: Relative salience of variables**

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  slider_model_age,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 tells us that TTcc \< KKcc, which suggests that listeners are more
likely to rate the speaker as older for TTcc than KKcc, and this is
statically significant based on the `Pr(>|z|)` column for our p-value
(\<0.001).

There is a priming effect here but only for conservative variants.

**H4: Order of presentation**

a)  ic \< ci

```{r}
comparisons(
  slider_model_age,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Row 1 is not significant, meaning there is no order effect

#### Plots

```{r}
plot_comparisons(
  slider_model_age,
  variables = "vowel_same",
  newdata = datagrid(grid_type = "balanced"),
  re.form = NA,
  by = c("v1_type", "manipulation_matching", "vowel_1")
)
```

### Gender model

```{r}
slider_model_gender <- lmer(
  slider_response ~ vowel_same * manipulation_matching * v1_type * vowel_1 + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp1_data_slider_final_gender,
)
```

```{r}
summary(slider_model_gender)
```

#### Hypothesis testing

**H1: Social meaning in isolation**

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  slider_model_gender,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 reaches close to significance (0.0742)

Listeners are not using variants for their gender ratings, but it is
close to significance for TRAP

**H2: Different variables vs repetition of same variables**

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  slider_model_gender,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)

```

Row 1 is not significant.

Row 2 is not significant.

Listeners are not covarying variants of KIT and TRAP for their gender
ratings any more than they do for KIT and TRAP independently.

**H3: Relative salience of variables**

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  slider_model_gender,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is significant meaning listeners are more likely to rate the
speaker as 'more masculine' for KKii stimuli than TTii stimuli

Row 2 is significant meaning listeners are more likely to rate the
speaker as 'more masculine' for KKcc stimuli than TTcc stimuli

**H4: Order of presentation**

a)  ic \< ci

```{r}
comparisons(
  slider_model_gender,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Row 1 is not significant, meaning there is no order effect.

#### Plots

```{r}
plot_comparisons(
  slider_model_gender,
  variables = "vowel_same",
  newdata = datagrid(grid_type = "balanced"),
  re.form = NA,
  by = c("v1_type", "manipulation_matching", "vowel_1")
)
```

### Education model

```{r}
slider_model_education <- lmer(
  slider_response ~ vowel_same * manipulation_matching * v1_type * vowel_1 + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp1_data_slider_final_education,
  control=lmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)) #will not converge without control
)
```

```{r}
summary(slider_model_education)
```

#### Hypothesis testing

Because we predict 'innovative' to be 'younger, less masculine, *and*
'less educated', we keep the hypotheses in the same direction (0 = less
educated, 1 = more educated).

**H1: Social meaning in isolation**

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  slider_model_education,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP")
  ),
  re.form = NA
)
```

Row 1 is significant (\<0.001)

Row 2 is significant (\<0.001)

Listeners are using variants of KIT and TRAP independently for their
education ratings

**H2: Different variables vs repetition of same variables**

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  slider_model_education,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)

```

Row 1 is not significant.

Row 2 is not significant.

Listeners are not covarying variants of KIT and TRAP for their education
ratings any more than they do for KIT and TRAP independently.

**H3: Relative salience of variables**

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  slider_model_education,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is not significant.

KIT and TRAP have the same level of salience for education ratings.

**H4: Order of presentation**

a)  ic \< ci

```{r}
comparisons(
  slider_model_education,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Row 1 is not significant meaning there is no order effect.

#### Plots

```{r}
exp1_data_slider_final_education <- exp1_data_slider_final_education %>% 
  mutate(
    pred_mod2 = predict(slider_model_education, type = "response"),
  )

#just the plot of H1
exp1_data_slider_final_education %>%
  filter(
    manipulation_matching == TRUE,
    vowel_same == TRUE
  ) %>% 
  ggplot(
    aes(
      x = v1_type,
      y = pred_mod2,
      colour = v1_type
    )
  ) +
  geom_boxplot() +
  facet_wrap(~vowel_1)

#plot of H1 and H2
exp1_slider_education_H1_H2 <- exp1_data_slider_final_education %>%
  filter(
    manipulation_matching == TRUE
  ) |> 
  ggplot(
    aes(
      x = vowel_same,
      y = pred_mod2,
      colour = v1_type
    )
  ) +
  geom_boxplot() +
  facet_wrap(~vowel_1) +
  ggtitle("Model predictions of H1 and H2 related variables for vowels-only slider education ratings") +
  theme(plot.title = element_text(size = 12)) +
  # KIT facet, FALSE, Conservative
  stat_summary(
    data = . %>% filter(vowel_1 == "KIT" & vowel_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = -0.175),
    geom = "text",
    aes(label = "KTcc"),
    color = "black",
    size = 4
  ) +
  # KIT facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(vowel_1 == "KIT" & vowel_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.01,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "KTii"),
    color = "black",
    size = 4
  ) +
  # KIT facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(vowel_1 == "KIT" & vowel_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = - 0.18),
    geom = "text",
    aes(label = "KKcc"),
    color = "black",
    size = 4
  ) +
  # KIT facet, TRUE, innovative
  stat_summary(
    data = . %>% filter(vowel_1 == "KIT" & vowel_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "KKii"),
    color = "black",
    size = 4
  ) +
  # TRAP facet. FALSE, conservative
  stat_summary(
    data = . %>% filter(vowel_1 == "TRAP" & vowel_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "TKcc"),
    color = "black",
    size = 4
  ) +
  # TRAP facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(vowel_1 == "TRAP" & vowel_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "TKii"),
    color = "black",
    size = 4
  ) +
  # TRAP facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(vowel_1 == "TRAP" & vowel_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "TTcc"),
    color = "black",
    size = 4
  ) +
  # TRAP facet, TRUE, innovative
    stat_summary(
    data = . %>% filter(vowel_1 == "TRAP" & vowel_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "TTii"),
    color = "black",
    size = 4
  )   +
  xlab("same vowel") +
  ylab("model predictions\n(higher = more well educated)") +
  theme(
    plot.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 13),
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12)
  ) +
  guides(colour = guide_legend(title = "first vowel manipulation")) 

exp1_slider_education_H1_H2
```

```{r}
plot_comparisons(
  slider_model_education,
  variables = "vowel_same",
  newdata = datagrid(grid_type = "balanced"),
  re.form = NA,
  by = c("v1_type", "manipulation_matching", "vowel_1")
)
```

Because H1 and H2 are significant, let's save these plots.

```{r, eval=FALSE}
ggsave(plot = exp1_slider_education_H1_H2, here("plots", "vowels_only", "exp1_slider_education_H1_H2.png"), width = 9, height = 6, dpi = 400)
```

### Accent model

```{r}
slider_model_accent <- lmer(
  slider_response_inverse ~ vowel_same * manipulation_matching * v1_type * vowel_1 + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp1_data_slider_final_accent, #removed block for singular fit issue
) #note the inverse data being modelled here
```

```{r}
summary(slider_model_accent)
```

#### Hypothesis testing

**H1: Social meaning in isolation**

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  slider_model_accent,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP")
  ),
  re.form = NA
)
```

Row 1 is significant (\<0.001)

Row 2 is significant (\<0.001)

Listeners are using variants of KIT and TRAP for accent ratings.

**H2: Different variables vs repetition of same variables**

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  slider_model_accent,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Hypothesis: VDcc \> VScc

Row 1 is significant (0.0324)

Hypothesis: VDii \< VSii

Row 2 is not significant

This is the first evidence for vocalic covariation in perception where
listeners are more likely to rate the speaker as 'strong NZ accent' if
they hear innovative KIT and TRAP together than hearing them separately.

**H3: Relative salience of variables**

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  slider_model_accent,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is not significant.

KIT and TRAP is equally salient in accent ratings.

**H4: Order of presentation**

a)  ic \< ci

```{r}
comparisons(
  slider_model_accent,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Row 1 is not significant, meaning there is no order effect

#### Plots

```{r}
exp1_data_slider_final_accent <- exp1_data_slider_final_accent %>% 
  mutate(
    pred_mod2 = predict(slider_model_accent, type = "response"),
  )

#just the plot of H1
exp1_data_slider_final_accent %>%
  filter(
    manipulation_matching == TRUE,
    vowel_same == TRUE
  ) %>% 
  ggplot(
    aes(
      x = v1_type,
      y = pred_mod2,
      colour = v1_type
    )
  ) +
  geom_boxplot() +
  facet_wrap(~vowel_1)

#plot of H1 and H2
exp1_slider_accent_H1_H2 <- exp1_data_slider_final_accent %>%
  filter(
    manipulation_matching == TRUE
  ) |> 
  ggplot(
    aes(
      x = vowel_same,
      y = pred_mod2,
      colour = v1_type
    )
  ) +
  geom_boxplot() +
  facet_wrap(~vowel_1) +
  ggtitle("Model predictions of H1 and H2 related variables for vowels-only slider accent ratings") +
  theme(plot.title = element_text(size = 12)) +
  # KIT facet, FALSE, Conservative
  stat_summary(
    data = . %>% filter(vowel_1 == "KIT" & vowel_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = -0.175),
    geom = "text",
    aes(label = "KTcc"),
    color = "black",
    size = 4
  ) +
  # KIT facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(vowel_1 == "KIT" & vowel_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "KTii"),
    color = "black",
    size = 4
  ) +
  # KIT facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(vowel_1 == "KIT" & vowel_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.03,
    position = position_nudge(x = - 0.18),
    geom = "text",
    aes(label = "KKcc"),
    color = "black",
    size = 4
  ) +
  # KIT facet, TRUE, innovative
  stat_summary(
    data = . %>% filter(vowel_1 == "KIT" & vowel_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "KKii"),
    color = "black",
    size = 4
  ) +
  # TRAP facet. FALSE, conservative
  stat_summary(
    data = . %>% filter(vowel_1 == "TRAP" & vowel_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "TKcc"),
    color = "black",
    size = 4
  ) +
  # TRAP facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(vowel_1 == "TRAP" & vowel_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "TKii"),
    color = "black",
    size = 4
  ) +
  # TRAP facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(vowel_1 == "TRAP" & vowel_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "TTcc"),
    color = "black",
    size = 4
  ) +
  # TRAP facet, TRUE, innovative
    stat_summary(
    data = . %>% filter(vowel_1 == "TRAP" & vowel_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.03,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "TTii"),
    color = "black",
    size = 4
  )   +
  xlab("same vowel") +
  ylab("model predictions\n(higher = not strong NZ accent)") +
  theme(
    plot.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 13),
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12)
  ) +
  guides(colour = guide_legend(title = "first vowel manipulation")) 

exp1_slider_accent_H1_H2
```

We plot the relevant model output.

```{r}
plot_comparisons(
  slider_model_accent,
  variables = "vowel_same",
  newdata = datagrid(grid_type = "balanced"),
  re.form = NA,
  by = c("v1_type", "manipulation_matching", "vowel_1")
)
```

Because H1 and H2 are significant, let's save these plots.

```{r, eval=FALSE}
ggsave(plot = exp1_slider_accent_H1_H2, here("plots", "vowels_only", "exp1_slider_accent_H1_H2.png"), width = 9, height = 6, dpi = 400)
```

## Post hoc analysis

So there's some interesting results here! It seems that KIT and TRAP are
not doing anything for ratings of age and gender but they are for
education and accent. Furthermore, listeners are patterning conservative
KIT and TRAP together for accent ratings in the slider task.

Here are some things we should check out:

-   rating for each task by *speaker* and *condition*

-   investigating the *free textbox comments* to see how they
    corroborate with the results (and looking into the results form
    participants who left relevant comments)

-   *pitch analysis* of speakers

Let's start with looking at distribution of responses with speaker in
mind

### Speaker investigation

```{r}
binary_response_table3 <- exp1_data_binary_final %>%
  group_by(dimension, stimulus_voice) %>%
  count(binary_response) %>%
  mutate(percentage = (n/sum(n)*100)) %>%
  rename(count = n,
         percentage = percentage) %>%
  ungroup() %>%
  mutate(dimension = factor(dimension, levels = c("age", "gender", "education", "accent")))

binary_response_table3$Rounded = round(binary_response_table3$percentage,2)

binary_speaker_plot1 <- binary_response_table3 %>%
  ggplot(aes(x=factor(binary_response, level = c('younger', 'older', 'less masculine', 'more masculine', 'less well educated', 'more well educated', 'strong NZ accent', 'not strong NZ accent')), y=percentage, fill=dimension)) + 
  geom_bar(stat = "identity") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  #guides(fill="none") +
  xlab("Forced-choice response") +
  ylab("Percentage") +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  facet_wrap(~stimulus_voice)

binary_speaker_plot1 #okay turns out what I thought would happen is happening for p01 (lowest pitch) and p08 (highest pitch) in terms of responses to the age and gender dimension

```

```{r}
binary_response_table4 <- exp1_data_binary_final %>%
  group_by(dimension, v_types_shorthand, stimulus_voice) %>%
  count(binary_response) %>%
  mutate(percentage = (n/sum(n)*100)) %>%
  rename(count = n,
         percentage = percentage) %>%
  ungroup() %>%
  mutate(dimension = factor(dimension, levels = c("age", "gender", "education", "accent"))) %>%
  mutate(speaker = fct_recode(stimulus_voice, 
                              "speaker1" = "p01",
                              "speaker4" = "p04",
                              "speaker5" = "p05", 
                              "speaker6" = "p06",
                              "speaker7" = "p07",
                              "speaker8" = "p08"))

binary_response_table4$Rounded = round(binary_response_table4$percentage,2)

binary_response_table4$dimension <- factor(binary_response_table4$dimension, levels=c('age', 'gender', 'education', 'accent'))

binary_response_table4$binary_response <- factor(binary_response_table4$binary_response, levels=c('older','younger', 'less masculine', 'more masculine', 'less well educated', 'more well educated', 'not strong NZ accent', 'strong NZ accent'))

binary_speaker_plot2 <- binary_response_table4 %>%
  filter(binary_response %in% c('younger', 'less masculine', 'less well educated', 'strong NZ accent')) %>%
  filter(v_types_shorthand %in% c("cc", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  guides(fill=guide_legend(title="Binary response")) +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("Percentage of 'innovative' responses per speaker for binary task for exp1") +
  #geom_segment(aes(x = 1, y = 65, xend = 4, yend = 90), size = 1, color = "gray46",
  #                arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  facet_grid(cols=vars(speaker), rows=vars(dimension)) +
  theme_gray()

binary_speaker_plot2

```

```{r}
exp1_data_slider_final <- exp1_data_slider_final %>%
  mutate(speaker = fct_recode(stimulus_voice, 
                              "speaker1" = "p01",
                              "speaker4" = "p04",
                              "speaker5" = "p05", 
                              "speaker6" = "p06",
                              "speaker7" = "p07",
                              "speaker8" = "p08"))

slider_speaker_plot1 <- exp1_data_slider_final %>%
  ggplot(aes(x=factor(dimension, level = c('age', 'gender', 'education', 'accent')), y=slider_response, fill=dimension)) + 
    geom_violin() +
    geom_boxplot(width = 0.3) +
    theme(legend.position="none") +
    xlab("Rating dimension") +
    ylab("Slider response") +
  facet_wrap(~speaker)

slider_speaker_plot1 
```

```{r}
slider_speaker_plot2 <- exp1_data_slider_final %>%
  filter(v_types_shorthand %in% c("cc", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot() +
    theme(legend.position="none") +
    guides(fill = "none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("Boxplot of slider responses per speaker for exp1") +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    #geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
    #              arrow = arrow(length = unit(0.5, "cm"))) +
    facet_grid(cols=vars(speaker), rows=vars(dimension)) +
    theme_gray()

slider_speaker_plot2 

exp1_data_slider_final %>%
  select(dimension, speaker, values_for_plotting, v_types_shorthand) %>%
  filter(v_types_shorthand %in% c("cc", "ii")) %>%
  group_by(speaker, dimension, v_types_shorthand) %>%
  summarise(slider_mean = mean(values_for_plotting))
```

Let's save these plots

```{r, eval=FALSE}
ggsave(plot = binary_speaker_plot2, here("plots", "vowels_only", "exp1_binary_speaker_plot.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = slider_speaker_plot2, here("plots", "vowels_only", "exp1_slider_speaker_plot.png"), width = 9, height = 6, dpi = 400)
```

I'm curious to see if the results for age and gender would change much
if we exclude p01 and p08. I know stimulus_voice is already a random
effect in the models here but perhaps their effect is quite strong?

#### Models excluding p01 and p08

```{r}
exp1_data_binary_age_four_speakers <- exp1_data_binary_final %>%
  filter(binary_response %in% c("younger", "older")) %>%
  filter(!stimulus_voice %in% c("p01", "p08"))

exp1_data_binary_gender_four_speakers <- exp1_data_binary_final %>%
  filter(binary_response %in% c("less masculine", "more masculine")) %>%
  filter(!stimulus_voice %in% c("p01", "p08"))

```

```{r}
binary_model_age_four_speakers <- glmer(
  binary_response_numeric ~ vowel_same * manipulation_matching * v1_type * vowel_1 + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  family = binomial,
  data = exp1_data_binary_age_four_speakers,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)) #does not converge without optimisation control
)
```

##### Binary age model

```{r}
summary(binary_model_age_four_speakers)
```

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  binary_model_age_four_speakers,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP")
  ),
  re.form = NA
)
```

Both hypotheses remain not significant.

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  binary_model_age_four_speakers,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Both hypotheses remain not significant.

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  binary_model_age_four_speakers,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Both remain significant here.

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  binary_model_age_four_speakers,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Hypothesis remains not significant.

So overall, the predictions do not change for age when removing the
'extreme' speakers (p01 and p08). Let's try the gender model now.

##### Binary gender model

```{r}
binary_model_gender_four_speakers <- glmer(
  binary_response_numeric ~ vowel_same * manipulation_matching * v1_type * vowel_1 + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  family = binomial,
  data = exp1_data_binary_gender_four_speakers,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5))
)
```

```{r}
summary(binary_model_gender_four_speakers)
```

H1: Social meaning in isolation

a)  KKii \< KKcc b) TTii \< TTcc

```{r}
comparisons(
  binary_model_gender_four_speakers,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP")
  ),
  re.form = NA
)
```

Both remain not significant.

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  binary_model_gender_four_speakers,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Both hypotheses remain not significant.

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  binary_model_gender_four_speakers,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Both remain significant here.

H4: Order of presentation

a)  ic \< ci (supported but not significant in original model)

```{r}
comparisons(
  binary_model_gender_four_speakers,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

This hypothesis remains not significant.

So removing speaker1 and speaker8 does not change the binary results for
age and gender.

Let's check the slider results.

```{r}
exp1_data_slider_age_four_speakers <- exp1_data_slider_final %>%
  filter(grepl(('old'), prompt)) %>%
  filter(!stimulus_voice %in% c("p01", "p08"))

exp1_data_slider_gender_four_speakers <- exp1_data_slider_final %>%
  filter(grepl(('masculine'), prompt)) %>%
  filter(!stimulus_voice %in% c("p01", "p08"))
```

##### Slider age model

```{r}
slider_model_age_four_speakers <- lmer(
  slider_response ~ vowel_same * manipulation_matching * v1_type * vowel_1 + (1|participant) + (1|stimulus_voice),
  data = exp1_data_slider_age_four_speakers,
) #removed block and word_pair for singular fit issue
```

```{r}
summary(slider_model_age_four_speakers)
```

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  slider_model_age_four_speakers,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP")
  ),
  re.form = NA
)
```

The first row is now significant (0.0366) The second row remains not
significant (0.9006).

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  slider_model_age_four_speakers,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

The hypotheses remain not significant.

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  slider_model_age_four_speakers,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is remains not significant (0.571).

Row 2 remains significant.

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  slider_model_age_four_speakers,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Hypothesis remains not significant.

##### Slider gender model

```{r}
slider_model_gender_four_speakers <- lmer(
  slider_response ~ vowel_same * manipulation_matching * v1_type * vowel_1 + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp1_data_slider_gender_four_speakers,
)
```

```{r}
summary(slider_model_gender_four_speakers)
```

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  slider_model_gender_four_speakers,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP")
  ),
  re.form = NA
)
```

Row 1 is now significant (0.0118).

Row 2 remains not significant.

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  slider_model_gender_four_speakers,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Both hypothese remains not significant.

H3: Relative salience of variables

a)  KKcc != TTcc (sig in original model)

b)  KKii != TTii (sig in original model)

```{r}
comparisons(
  slider_model_gender_four_speakers,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 remains significant.

Row 2 is now not significant.

H4: Order of presentation

a)  ic \< ci (not supported in original model)

```{r}
comparisons(
  slider_model_gender_four_speakers,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Hypothesis remains not significant.

Overall it appears that pitch is definitely playing a role. Hypotheses
that were close to significance in the original slider models reaches
significance when removing speaker1 and speaker8.

### Free text comments

It would be good to investigate the comments people left about the
experiment! Maybe even investigate the participants who left comments to
see whether what they think matches their actual response patterns.

```{r}
exp1_all_participant_comments <- exp1_participant_data_information %>%
  select(experiment, response, FreeText) %>%
  unique()

exp1_all_participant_comments <- exp1_all_participant_comments %>%
  filter(!FreeText == "NA") %>%
  filter(!FreeText == "")

head(exp1_all_participant_comments)

#let's only keep the relevant comments
all_participant_comments_filtered <- exp1_all_participant_comments %>%
  filter(!experiment %in% c("exp94", "exp215", "exp231", "exp240", "exp247", "exp397", "exp429", "exp574", "exp873", "exp989", "exp1139", "exp1290"))

head(all_participant_comments_filtered)

```

We can explore the responses from participants with particularly
interesting comments (exp139 (binary), exp206 (slider), exp575
(slider)).

```{r}
exp139_table <- exp1_data_binary_final %>%
  filter(participant == "exp139") %>%
  group_by(dimension, v_types_shorthand) %>%
  count(binary_response) %>%
  mutate(percentage = (n/sum(n)*100)) %>%
  rename(count = n,
         percentage = percentage) %>%
  ungroup() 

exp139_table$Rounded = round(exp139_table$percentage,2)

exp139_table$dimension <- factor(exp139_table$dimension, levels=c('age', 'gender', 'education', 'accent'))
exp139_table$binary_response <- factor(exp139_table$binary_response, levels=c('older','younger', 'less masculine', 'more masculine', 'less well educated', 'more well educated', 'not strong NZ accent', 'strong NZ accent'))

y_labels <- c("0", "25", "50", "75", "100")

exp139_distribution <- exp139_table %>%
  filter(binary_response %in% c('younger', 'less masculine', 'less well educated', 'strong NZ accent')) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  #guides(fill="none") +
  guides(fill=guide_legend(title="Binary response")) +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  #geom_segment(aes(x = 1, y = 65, xend = 4, yend = 90), size = 1, color = "gray46",
  #                arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  ggtitle("Percentage of responses by social dimension for participant 139") +
  theme(plot.title = element_text(size = 10)) +
  facet_wrap(~dimension) +
  theme_gray()

exp139_distribution

#note: no table has been made per speaker because there isn't enough stimuli per speaker

```

Comment: I found as the sets of words ran through, my ear started
adjusting to the accents and tones I was listening to, so my choices
became less sure. I found *higher voice tones* AND *stronger NZ accent*
sounded *less masculine*, which surprised me. A *more cultured accent*
sounded *more mature and masculine*. Some words weren't so easy to pick
as demonstrating a strong NZ accent or not, but the *words with 'i'
(sounding more 'u') and 'a' (sounding more 'e') vowels depicted a strong
NZ accent*. I definitely found myself rating a *stronger NZ accent* as
indicating *less education*, but on reflection, a stronger accent could
be regional or rural. An interesting study!!

```{r, eval=FALSE}
ggsave(plot = exp139_distribution, here("plots", "vowels_only", "exp1_participant139_distribution.png"), width = 9, height = 6, dpi = 400)
```

```{r}
exp206_distribution <- exp1_data_slider_final %>%
  filter(participant == "exp206") %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot() +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
  ggtitle("Boxplot of responses to each manipulation pair by social dimension for participant 206") +
  theme(plot.title = element_text(size = 10)) +
  facet_wrap(~dimension)

exp206_distribution 

exp206_distribution2 <- exp1_data_slider_final %>%
  filter(participant == "exp206") %>%
  filter(dimension %in% c("age", "education")) %>%
  filter(v_types_shorthand %in% c("cc", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting)) + 
    #geom_violin() +
    geom_boxplot() +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
  ggtitle("Boxplot to each manipulation pair by age and education dimension for participant 206") +
  theme(plot.title = element_text(size = 10)) +
  facet_grid(cols=vars(speaker), rows=vars(dimension)) +
  theme_gray()

exp206_distribution2
```

Comment: It probably says more about me than about your experiment, but
I found it very conspicuous when the speaker did not enunciate the
'correct' consonant at the end of (usually) the second word. I also
noticed a tendency to assume that a *higher pitched voice* was *younger*
than a lower pitch, and a tendency to *equate enunciation with
education*. I'll be very interested to see the results.

```{r, eval=FALSE}
#ggsave(plot = exp206_distribution, here("plots", "exp1_exp206_distribution_allspeakers.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = exp206_distribution2, here("plots", "vowels_only", "exp1_participant206_age_education_byspeaker.png"), width = 9, height = 6, dpi = 400)
```

```{r}
exp575_distribution <- exp1_data_slider_final %>%
  filter(participant == "exp575") %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot() +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
  ggtitle("Boxplot of responses to each manipulation pair by social dimension for participant 575") +
  theme(plot.title = element_text(size = 10)) +
  facet_wrap(~dimension)

exp575_distribution2 <- exp1_data_slider_final %>%
  filter(participant == "exp575") %>%
  filter(v_types_shorthand %in% c("cc", "ii")) %>%
  filter(dimension == "education") %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting)) + 
    # Add the rectangles first so they appear behind the boxplots
    geom_rect(data = . %>% 
                filter(stimulus_voice %in% c("p05", "p06", "p08")),
              aes(xmin = -Inf, xmax = Inf, 
                  ymin = -Inf, ymax = Inf),
              fill = NA, 
              color = "red",
              size = 1.2,
              inherit.aes = FALSE) +
    geom_boxplot() +
    # Add mean values
    #stat_summary(fun = mean, 
    #            geom = "text", 
    #            aes(label = sprintf("%.2f", after_stat(y))),
    #            vjust = -0.5) +
    theme(legend.position = "none",
          strip.background = element_blank(),
          panel.spacing = unit(1.5, "lines"),
          panel.border = element_rect(color = "black", fill = NA)) +
    xlab("Manipulation pair") +
    ylab("Slider response to education ratings") +
    ggtitle("Boxplot of responses by education ratings for participant 575") +
    facet_wrap(~factor(speaker, c("speaker1", "speaker4", "speaker7", "speaker5", "speaker6", "speaker8"))) +
    theme_grey()

exp575_distribution 
exp575_distribution2
exp1_data_slider_final %>%
  filter(participant == "exp575") %>%
  filter(dimension == "education") %>%
  filter(v_types_shorthand %in% c("cc", "ii")) %>%
  group_by(stimulus_voice, v_types_shorthand) %>%
  summarize(mean_education_response = mean(slider_response, na.rm = TRUE))

```

Comment: I found I was quite conscious of my internal bias and
preconceptions during the first task where I rated speakers on how
educated I thought they were. I quickly began noticing that any speakers
who I perceived as having *more north island accents*, sounding *more
Mori*, or who had *worse pronunciation* sounded *less educated* to me.
This was most strongly felt during that task, while the other rating
tasks I was not as uncomfortably aware of the associations I was making.

```{r, eval=FALSE}
#ggsave(plot = exp575_distribution, here("plots", "exp1_exp575_distribution_allspeakers.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = exp575_distribution2, here("plots", "vowels_only", "exp1_participant575_distribution_byspeaker.png"), width = 9, height = 6, dpi = 400)
```

### Pitch analysis

Based on both post hoc analyses above, pitch clearly plays an important
role, particularly for age and gender ratings.

Let's start by getting a better understanding of the pitch mean and
variation we are dealing with for the six speakers.

The mean readings here are from the all original recordings. This is
because a lot of the vowels-only word pairs had really short vowels (in
the original recording), which gave more inaccurate pitch readings. The
formant manipulation script should not have influenced the pitch in the
recordings.

```{r}
raw_f0 <- read.csv(here("data", "F0_all_speakers_original_recordings.csv")) %>%
  rename("mean_F0" = "Mean_F0_.Hz.")

raw_f0$stimulus_voice <- sub("-.*$", "", raw_f0$Filename)

raw_f0 <- raw_f0 %>%
  mutate(stimulus_voice = case_when(
    str_detect(stimulus_voice, "p_01") ~ "p01",
    str_detect(stimulus_voice, "p_04") ~ "p04",
    str_detect(stimulus_voice, "p_05") ~ "p05",
    str_detect(stimulus_voice, "p_06") ~ "p06",
    str_detect(stimulus_voice, "p_07") ~ "p07",
    str_detect(stimulus_voice, "p_08") ~ "p08"
  ))

#let's remove what we can assume are incorrect readings and then do an outlier removal
tidy_f0 <- raw_f0 %>%
  filter(!mean_F0 >= 200)

#outlier removal
sd_limit = 2.5

#calculate the summary statistics required for the outlier removal
tidy_f0_summary <- tidy_f0 %>%
  group_by(stimulus_voice) %>%
  summarise(n = n(),
            mean_pitch = mean(mean_F0, na.rm = TRUE),
            sd_pitch = sd(mean_F0, na.rm = TRUE),
            min_pitch = mean(mean_F0) - sd_limit*(sd(mean_F0)),
            max_pitch = mean(mean_F0) + sd_limit*(sd(mean_F0))
            )

#store the outlier tokens data
outlier_tokens <- tidy_f0 %>%
  inner_join(., tidy_f0_summary) %>%
  mutate(outlier = ifelse(mean_F0 > min_pitch &
           mean_F0 < max_pitch, FALSE, TRUE)) %>%
  group_by(stimulus_voice) %>%
  filter(outlier == TRUE) %>%
  ungroup()

#add the summary statistics and filter out outliers
tidy_f0 <- tidy_f0 %>%
  inner_join(., tidy_f0_summary) %>%
  mutate(outlier = ifelse(mean_F0 > min_pitch &
           mean_F0 < max_pitch, FALSE, TRUE)) %>%
  group_by(stimulus_voice) %>%
  filter(outlier == FALSE) %>%
  ungroup() %>%
  select(Filename:stimulus_voice)

tidy_f0 %>%
  group_by(stimulus_voice) %>%
  summarise(mean = mean(mean_F0)) %>%
  arrange(desc(mean))

tidy_f0_summary2 <- tidy_f0 %>%
  group_by(stimulus_voice) %>%
  summarise(n = n(),
            mean_pitch = mean(mean_F0, na.rm = TRUE)) %>%
  select(-n)

rm(raw_f0, tidy_f0, tidy_f0_summary)

```

speaker1 has the lowest mean pitch (95.25652Hz) while speaker8 has the
highest mean pitch (137.39230) - this difference is quite clear when you
listen to lots of the final stimuli!

We could add this mean pitch to, at least, the age and gender models to
see whether this is significant and if controlling for pitch helps other
variables shine through.

#### Binary age model

```{r}
exp1_data_binary_final_age_pitch <- left_join(
  exp1_data_binary_final_age,
  tidy_f0_summary2,
  by="stimulus_voice"
)

#we will need to rescale the pitch variables
exp1_data_binary_final_age_pitch <- exp1_data_binary_final_age_pitch %>%
  mutate(mean_pitch_scaled = scale(mean_pitch, center=T, scale=T)[,1])

head(exp1_data_binary_final_age_pitch)

binary_model_age_pitch <- glmer(
  binary_response_numeric ~ vowel_same * manipulation_matching * v1_type * vowel_1 * mean_pitch_scaled + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  family = binomial,
  data = exp1_data_binary_final_age_pitch,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)) #does not converge without optimisation control
)

summary(binary_model_age_pitch)
```

We can see if controlling for pitch changes the hypothesis tests

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  binary_model_age_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 remains not significant.

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  binary_model_age_pitch,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H2 remains not significant.

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  binary_model_age_pitch,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H3 remains significant here (KIT mean large, closer to '1').

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  binary_model_age_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE,
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H4 remains significant.

Overall, controlling for pitch does not change the hypothesis tests,
meaning the vowels are really not likely to be doing anything for the
binary age ratings.

#### Binary gender model

```{r}
exp1_data_binary_final_gender_pitch <- left_join(
  exp1_data_binary_final_gender,
  tidy_f0_summary2,
  by="stimulus_voice"
)

#we will need to rescale the pitch variables
exp1_data_binary_final_gender_pitch <- exp1_data_binary_final_gender_pitch %>%
  mutate(mean_pitch_scaled = scale(mean_pitch, center=T, scale=T)[,1])

head(exp1_data_binary_final_gender_pitch)

binary_model_gender_pitch <- glmer(
  binary_response_numeric ~ vowel_same * manipulation_matching * v1_type * vowel_1 * mean_pitch_scaled + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  family = binomial,
  data = exp1_data_binary_final_gender_pitch,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5))
)

summary(binary_model_gender_pitch)
```

We can see if controlling for pitch changes the hypothesis tests

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  binary_model_gender_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 remains not significant.

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  binary_model_gender_pitch,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H2 remains not significant.

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  binary_model_gender_pitch,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H3 remains significant here (KIT mean large, closer to '1').

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  binary_model_gender_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE,
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H4 remains not significant.

For the binary data overall, controlling for pitch does not change the
role of the vowels (which is that they have no role in the perception of
social meaning).

#### Slider age model

```{r}
exp1_data_slider_final_age_pitch <- left_join(
  exp1_data_slider_final_age,
  tidy_f0_summary2,
  by="stimulus_voice"
)

#we will need to rescale the pitch variables
exp1_data_slider_final_age_pitch <- exp1_data_slider_final_age_pitch %>%
  mutate(mean_pitch_scaled = scale(mean_pitch, center=T, scale=T)[,1])

head(exp1_data_slider_final_age_pitch)

slider_model_age_pitch <- lmer(
  slider_response ~ vowel_same * manipulation_matching * v1_type * vowel_1 * mean_pitch_scaled + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp1_data_slider_final_age_pitch,
) #removed block for singular fit issue

summary(slider_model_age_pitch)
```

Guess what: more hypothesis tests!

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  slider_model_age_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 remains not significant.

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  slider_model_age_pitch,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H2 remains not significant.

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  slider_model_age_pitch,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H3 remains the same.

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  slider_model_age_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE,
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H4 remains not significant

#### Slider gender model

```{r}
exp1_data_slider_final_gender_pitch <- left_join(
  exp1_data_slider_final_gender,
  tidy_f0_summary2,
  by="stimulus_voice"
)

#we will need to rescale the pitch variables
exp1_data_slider_final_gender_pitch <- exp1_data_slider_final_gender_pitch %>%
  mutate(mean_pitch_scaled = scale(mean_pitch, center=T, scale=T)[,1])

head(exp1_data_slider_final_gender_pitch)

slider_model_gender_pitch <- lmer(
  slider_response ~ vowel_same * manipulation_matching * v1_type * vowel_1 * mean_pitch_scaled + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp1_data_slider_final_gender_pitch,
)

summary(slider_model_gender_pitch)
```

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  slider_model_gender_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 remains not significant.

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  slider_model_gender_pitch,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H2 does not change. VSii\>VDii is significant, but this is the same as
the original models (i.e., when not controlling for pitch).

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  slider_model_gender_pitch,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H3 remains significant.

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  slider_model_gender_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE,
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H4 remains not significant.

Great, so the vowels really aren't doing anything for perceived social
meaning on these dimensions.

I may as well look at education and accent too.

#### Binary education model

```{r}
exp1_data_binary_final_education_pitch <- left_join(
  exp1_data_binary_final_education,
  tidy_f0_summary2,
  by="stimulus_voice"
)

#we will need to rescale the pitch variables
exp1_data_binary_final_education_pitch <- exp1_data_binary_final_education_pitch %>%
  mutate(mean_pitch_scaled = scale(mean_pitch, center=T, scale=T)[,1])

head(exp1_data_binary_final_education_pitch)

binary_model_education_pitch <- glmer(
  binary_response_numeric ~ vowel_same * manipulation_matching * v1_type * vowel_1 * mean_pitch_scaled + (1|participant) + (1|word_pair) + (1|stimulus_voice), #need to remove block for singular fit error
  family = binomial,
  data = exp1_data_binary_final_education_pitch,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5))
)

summary(binary_model_education_pitch)
```

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  binary_model_education_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 remains significant.

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  binary_model_education_pitch,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H2 remains not significant.

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  binary_model_education_pitch,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H3 remains not significant.

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  binary_model_education_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE,
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H4 remains not significant.

#### Binary accent model

```{r}
exp1_data_binary_final_accent_pitch <- left_join(
  exp1_data_binary_final_accent,
  tidy_f0_summary2,
  by="stimulus_voice"
)

#we will need to rescale the pitch variables
exp1_data_binary_final_accent_pitch <- exp1_data_binary_final_accent_pitch %>%
  mutate(mean_pitch_scaled = scale(mean_pitch, center=T, scale=T)[,1])

head(exp1_data_binary_final_accent_pitch)

binary_model_accent_pitch <- glmer(
  binary_response_numeric ~ vowel_same * manipulation_matching * v1_type * vowel_1 * mean_pitch_scaled + (1|participant) + (1|stimulus_voice),
  family = binomial,
  data = exp1_data_binary_final_accent_pitch,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)) #removed block (first) and word_pair (second) (both with variance close to 0) to fix singular fit issue
)

summary(binary_model_accent_pitch)
```

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  binary_model_accent_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 remains significant.

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  binary_model_accent_pitch,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H2 remains not significant.

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  binary_model_accent_pitch,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H3 remains not significant.

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  binary_model_accent_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE,
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H4 remains not significant.

#### Slider education model

```{r}
exp1_data_slider_final_education_pitch <- left_join(
  exp1_data_slider_final_education,
  tidy_f0_summary2,
  by="stimulus_voice"
)

#we will need to rescale the pitch variables
exp1_data_slider_final_education_pitch <- exp1_data_slider_final_education_pitch %>%
  mutate(mean_pitch_scaled = scale(mean_pitch, center=T, scale=T)[,1])

head(exp1_data_slider_final_education_pitch)

slider_model_education_pitch <- lmer(
  slider_response ~ vowel_same * manipulation_matching * v1_type * vowel_1 * mean_pitch_scaled + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp1_data_slider_final_education_pitch,
  control=lmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)) #will not converge without control
)

summary(slider_model_education_pitch)
```

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  slider_model_education_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 remains significant.

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  slider_model_education_pitch,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H2 remains not significant.

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  slider_model_education_pitch,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H3 remains not significant.

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  slider_model_education_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE,
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H4 remains not significant.

#### Slider accent model

```{r}
exp1_data_slider_final_accent_pitch <- left_join(
  exp1_data_slider_final_accent,
  tidy_f0_summary2,
  by="stimulus_voice"
)

#we will need to rescale the pitch variables
exp1_data_slider_final_accent_pitch <- exp1_data_slider_final_accent_pitch %>%
  mutate(mean_pitch_scaled = scale(mean_pitch, center=T, scale=T)[,1])

head(exp1_data_slider_final_accent_pitch)

slider_model_accent_pitch <- lmer(
  slider_response_inverse ~ vowel_same * manipulation_matching * v1_type * vowel_1 * mean_pitch_scaled + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp1_data_slider_final_accent_pitch, #removed block for singular fit issue
) #note the inverse data being modelled here

summary(slider_model_accent_pitch)
```

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  slider_model_accent_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 remains significant.

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  slider_model_accent_pitch,
  variables = "vowel_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_1" = c("KIT", "TRAP"),
    "vowel_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H2 remains the same.

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  slider_model_accent_pitch,
  variables = "vowel_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "vowel_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H3 remains not significant.

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  slider_model_accent_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  # newdata = binary_data |> 
  #   filter(manipulation_matching == FALSE),
  newdata = datagrid(
    "manipulation_matching" = FALSE,
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H4 remains not significant.

Now we move onto analysing the results from the second experiment which
aimed to investigate the perceived social meaning from TRAP (innovative
and conservative) and intervocalic medial /t/ (fricated and flapped).

# **Vowel-and-t experiment**

Now, we can move onto the second experiment.

Let's load in the tidy data which we will use to analyse the results.

```{r}
exp2_data_binary_final <- read.csv(here("data", "exp2_data_binary_final.csv"))
exp2_data_slider_final <- read.csv(here("data", "exp2_data_slider_final.csv"))
exp2_participant_data_information <- read.csv(here("data", "exp2_participant_data_information.csv"))
```

Let's look at the demographic information of the participants.

```{r}
exp2_participant_data_information <- exp2_participant_data_information %>%
  mutate(qGender = fct_recode(factor(qGender),
                            "woman" = "female",
                            "woman" = "Female",
                            "woman" = "Woman",
                            "man" = "Man",
                            "man" = "male",
                            "man" = "Male",
                            "nonbinary" = "Genderfluid/ biologically female",
                            "nonbinary" = "Non-binary, AFAB"))

#how many participants?
exp2_participant_data_information_unique <- exp2_participant_data_information %>%
  select(1, 9, 12) %>%
  unique() #90 participants

exp2_binary_information_unique <- exp2_participant_data_information %>%
  filter(response == "forced-choice") %>%
  select(1, 9, 12) %>%
  unique() #45 binary participants

exp2_slider_information_unique <- exp2_participant_data_information %>%
  filter(response == "slider") %>%
  select(1, 9, 12) %>%
  unique() #45 slider participants

#checking the demographics
table(exp2_participant_data_information_unique$qAge)
table(exp2_binary_information_unique$qAge)
table(exp2_slider_information_unique$qAge)

table(exp2_participant_data_information_unique$qGender) 
table(exp2_binary_information_unique$qGender) 
table(exp2_slider_information_unique$qGender) 

table(exp2_participant_data_information_unique$qGender, exp2_participant_data_information_unique$qAge)
table(exp2_binary_information_unique$qGender, exp2_binary_information_unique$qAge)
table(exp2_slider_information_unique$qGender, exp2_slider_information_unique$qAge)

rm(exp2_participant_data_information_unique, 
   exp2_binary_information_unique,
   exp2_slider_information_unique)
```

## Hypotheses

Like the first experiment, we'll use the `marginaleffects` package for
our hypothesis testing. Here is our predictions for the vowels-and-t
experiment.

Here is the guide for the hypothesis:

-   TT = word-pairs with two TRAP vowels (e.g., *cabin dagger*)

-   tt = word-pairs with two /t/ consonants and no TRAP vowel (e.g.,
    *party button*)

-   i = innovative manipulation (ii = two innovative manipulations)
    (note this is relative to the social dimension)

-   c = conservative manipulation (cc = two conservative manipulations)
    (note this is relative to the social dimension)

-   VD = the variables in the word-pair are different (e.g., *party
    cabin, dagger party*)

-   VS = the variables in the word-pair are the same (e.g., *cabin
    dagger, party button*)

-   ic = innovative + conservative manipulation

-   ci = conservative + innovative manipulation

[H1: Social meaning in isolation (TRAP and /t/)]{.underline}

a)  *TTii \< TTcc* (-ii will have more younger, less masculine, less
    well educated, and strong NZ accent responses (lower estimate mean)
    than -cc for TT) (note that this is the same as the first
    experiment).

b)  *ttii \< ttcc* (-ii will have more younger, less masculine, less
    well educated, and strong NZ accent responses (lower estimate mean)
    than -cc for tt) (see note below)\*

[H2: Different variables vs repetition of same variables]{.underline}

a)  *VDcc = VScc* (there will be no robust rating difference between VD
    and VS stimuli for their respective matching conservative
    manipulations).

b)  *VDii = VSii* (there will be no robust rating difference between VD
    and VS stimuli for their respective matching innovative
    manipulations).

[H3: Relative salience of variables]{.underline}

a)  *TTcc != ttcc* (TTcc will not have the same mean responses as ttcc).

b)  *TTii != ttii* (TTii will not have the same mean responses as ttii).

[H4: Order of presentation]{.underline}

a)  *ic \< ci* (in mismatching conditions, an innovative first
    manipulation will have more responses towards the predicted
    'innovative' direction (lower estimate mean) than a conservative
    first manipulation

For one-sided tests (H1 and H4), we judge significance by the
`p(NonSup)` columns. For the other tests (H2 and H3), we judge the
significant of the `Pr(>|z|)` column because we are just seeing if there
is a significant difference between to variables (rather than a
significant difference *from* a variable).

\*Note that the predicted social direction is slightly different for
these manipulations with respect to gender. This is because we expect
that fricated /t/ manipulations will result in more older, **less
masculine**, more well educated, and not strong NZ accent ratings while
flapped /t/ manipulations will result in more younger, **more
masculine**, less well educated, and strong NZ accent ratings. So for
gender, -ss manipulations (two fricated /t/) will be treated as -ii but
for age, education, and accent, -ss will be treated as -cc.

## Binary analysis

We split up the `exp2_data_binary_final` into the four social
dimensions.

```{r}
exp2_data_binary_final_age <- exp2_data_binary_final %>%
  filter(binary_response %in% c("younger", "older"))

exp2_data_binary_final_gender <- exp2_data_binary_final %>%
  filter(binary_response %in% c("less masculine", "more masculine"))

exp2_data_binary_final_education <- exp2_data_binary_final %>%
  filter(binary_response %in% c("less well educated", "more well educated"))

exp2_data_binary_final_accent  <- exp2_data_binary_final %>%
  filter(binary_response %in% c("not strong NZ accent", "strong NZ accent"))
```

Let's check the distribution of just some of this data.

```{r}
binary_response_table <- exp2_data_binary_final %>%
  group_by(dimension) %>%
  count(binary_response) %>%
  mutate(percentage = (n/sum(n)*100)) %>%
  rename(count = n,
         percentage = percentage) %>%
  ungroup() %>%
  mutate(dimension = factor(dimension, levels = c("age", "gender", "education", "accent")))

binary_response_table$Rounded = round(binary_response_table$percentage,2)

binary_distribution_plot <- binary_response_table %>%
  ggplot(aes(x=factor(binary_response, level = c('younger', 'older', 'less masculine', 'more masculine', 'less well educated', 'more well educated', 'strong NZ accent', 'not strong NZ accent')), y=percentage, fill=dimension)) + 
  geom_bar(stat = "identity") +
  geom_text(aes(label=Rounded),vjust = -0.25)+
  #guides(fill="none") +
  xlab("Forced-choice response to all social dimensions") +
  ylab("Percentage of responses") +
  scale_x_discrete(guide = guide_axis(angle = 45))

binary_distribution_plot

```

Let's get it more specific

```{r}
binary_response_table2 <- exp2_data_binary_final %>%
  group_by(dimension, v_types_shorthand, vs) %>%
  count(binary_response) %>%
  mutate(percentage = (n/sum(n)*100)) %>%
  rename(count = n,
         percentage = percentage) %>%
  ungroup() 

binary_response_table2$Rounded = round(binary_response_table2$percentage,2)

binary_response_table2$dimension <- factor(binary_response_table2$dimension, levels=c('age', 'gender', 'education', 'accent'))
binary_response_table2$binary_response <- factor(binary_response_table2$binary_response, levels=c('older','younger', 'less masculine', 'more masculine', 'less well educated', 'more well educated', 'not strong NZ accent', 'strong NZ accent'))

#TRAP-TRAP stimuli
TRAPTRAP_binary_age <- binary_response_table2 %>%
  filter(binary_response %in% c('younger')) %>%
  filter(v_types_shorthand %in% c("cc", "ci", "ic", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  guides(fill="none") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'younger' responses") +
  geom_segment(aes(x = 1, y = 70, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

TRAPTRAP_binary_age

TRAPTRAP_binary_gender <- binary_response_table2 %>%
  filter(binary_response %in% c('less masculine')) %>%
  filter(v_types_shorthand %in% c("cc", "ci", "ic", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage)) + 
  geom_bar(stat = "identity", fill="#7CAE00") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'less masculine' responses") +
  geom_segment(aes(x = 1, y = 70, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

TRAPTRAP_binary_gender

TRAPTRAP_binary_education <- binary_response_table2 %>%
  filter(binary_response %in% c('less well educated')) %>%
  filter(v_types_shorthand %in% c("cc", "ci", "ic", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage)) + 
  geom_bar(stat = "identity", fill="#00BFC4") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'less well educated' responses") +
  geom_segment(aes(x = 1, y = 70, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

TRAPTRAP_binary_education

TRAPTRAP_binary_accent <- binary_response_table2 %>%
  filter(binary_response %in% c('strong NZ accent')) %>%
  filter(v_types_shorthand %in% c("cc", "ci", "ic", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage)) + 
  geom_bar(stat = "identity", fill="#C77CFF") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'strong NZ accent' responses") +
  geom_segment(aes(x = 1, y = 70, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

TRAPTRAP_binary_accent

TRAPTRAP_binary_plot_all <- (TRAPTRAP_binary_age + TRAPTRAP_binary_gender) / (TRAPTRAP_binary_education + TRAPTRAP_binary_accent)

TRAPTRAP_binary_plot_all + plot_annotation(
  title = "Percentage of predicted binary responses to TRAP-TRAP stimuli"
)

```

```{r}
#TRAP-t stimuli
TRAPt_binary_age <- binary_response_table2 %>%
  filter(binary_response %in% c('younger')) %>%
  filter(v_types_shorthand %in% c("cr", "cs", "ir", "is")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("cs", "cr", "is", "ir"))) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  guides(fill="none") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'younger' responses") +
  geom_segment(aes(x = 1, y = 70, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

TRAPt_binary_age

TRAPt_binary_gender <- binary_response_table2 %>%
  filter(binary_response %in% c('less masculine')) %>%
  filter(v_types_shorthand %in% c("cr", "cs", "ir", "is")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage)) + 
  geom_bar(stat = "identity", fill="#7CAE00") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'less masculine' responses") +
  geom_segment(aes(x = 1, y = 70, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

TRAPt_binary_gender

TRAPt_binary_education <- binary_response_table2 %>%
  filter(binary_response %in% c('less well educated')) %>%
  filter(v_types_shorthand %in% c("cr", "cs", "ir", "is")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("cs", "cr", "is", "ir"))) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage)) + 
  geom_bar(stat = "identity", fill="#00BFC4") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'less well educated' responses") +
  geom_segment(aes(x = 1, y = 70, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

TRAPt_binary_education

TRAPt_binary_accent <- binary_response_table2 %>%
  filter(binary_response %in% c('strong NZ accent')) %>%
  filter(v_types_shorthand %in% c("cr", "cs", "ir", "is")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("cs", "cr", "is", "ir"))) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage)) + 
  geom_bar(stat = "identity", fill="#C77CFF") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'strong NZ accent' responses") +
  geom_segment(aes(x = 1, y = 70, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

TRAPt_binary_accent

TRAPt_binary_plot_all <- (TRAPt_binary_age + TRAPt_binary_gender) / (TRAPt_binary_education + TRAPt_binary_accent)

TRAPt_binary_plot_all + plot_annotation(
  title = "Percentage of predicted binary responses to TRAP-t stimuli"
)

```

```{r}
#TRAP-t stimuli
tTRAP_binary_age <- binary_response_table2 %>%
  filter(binary_response %in% c('younger')) %>%
  filter(v_types_shorthand %in% c("rc", "sc", "ri", "si")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("sc", "si", "rc", "ri"))) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  guides(fill="none") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'younger' responses") +
  geom_segment(aes(x = 1, y = 70, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

tTRAP_binary_age

tTRAP_binary_gender <- binary_response_table2 %>%
  filter(binary_response %in% c('less masculine')) %>%
  filter(v_types_shorthand %in% c("rc", "sc", "ri", "si")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage)) + 
  geom_bar(stat = "identity", fill="#7CAE00") +
  guides(fill="none") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'less masculine' responses") +
  geom_segment(aes(x = 1, y = 70, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

tTRAP_binary_gender

tTRAP_binary_education <- binary_response_table2 %>%
  filter(binary_response %in% c('less well educated')) %>%
  filter(v_types_shorthand %in% c("rc", "sc", "ri", "si")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("sc", "si", "rc", "ri"))) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity", fill="#00BFC4") +
  guides(fill="none") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'less well educated' responses") +
  geom_segment(aes(x = 1, y = 70, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

tTRAP_binary_education

tTRAP_binary_accent <- binary_response_table2 %>%
  filter(binary_response %in% c('strong NZ accent')) %>%
  filter(v_types_shorthand %in% c("rc", "sc", "ri", "si")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("sc", "si", "rc", "ri"))) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity", fill="#C77CFF") +
  guides(fill="none") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'strong NZ accent' responses") +
  geom_segment(aes(x = 1, y = 70, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

tTRAP_binary_accent

tTRAP_binary_plot_all <- (tTRAP_binary_age + tTRAP_binary_gender) / (tTRAP_binary_education + tTRAP_binary_accent)

tTRAP_binary_plot_all + plot_annotation(
  title = "Percentage of predicted binary responses to t-TRAP stimuli"
)
```

```{r}
#t-t stimuli
tt_binary_age <- binary_response_table2 %>%
  filter(binary_response %in% c('younger')) %>%
  filter(v_types_shorthand %in% c("rr", "rs", "sr", "ss")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("ss", "sr", "rs", "rr"))) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  guides(fill="none") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'younger' responses") +
  geom_segment(aes(x = 1, y = 70, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

tt_binary_age

tt_binary_gender <- binary_response_table2 %>%
  filter(binary_response %in% c('less masculine')) %>%
  filter(v_types_shorthand %in% c("rr", "rs", "sr", "ss")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage)) + 
  geom_bar(stat = "identity", fill="#7CAE00") +
  guides(fill="none") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'less masculine' responses") +
  geom_segment(aes(x = 1, y = 70, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

tt_binary_gender

tt_binary_education <- binary_response_table2 %>%
  filter(binary_response %in% c('less well educated')) %>%
  filter(v_types_shorthand %in% c("rr", "sr", "rs", "ss")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("ss", "sr", "rs", "rr"))) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity", fill="#00BFC4") +
  guides(fill="none") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'less well educated' responses") +
  geom_segment(aes(x = 1, y = 70, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

tt_binary_education

tt_binary_accent <- binary_response_table2 %>%
  filter(binary_response %in% c('strong NZ accent')) %>%
  filter(v_types_shorthand %in% c("rr", "sr", "rs", "ss")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("ss", "sr", "rs", "rr"))) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity", fill="#C77CFF") +
  guides(fill="none") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'strong NZ accent' responses") +
  geom_segment(aes(x = 1, y = 70, xend = 4, yend = 90), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
  ylim(0,100) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

tt_binary_accent

tt_binary_plot_all <- (tt_binary_age + tt_binary_gender) / (tt_binary_education + tt_binary_accent)

tt_binary_plot_all + plot_annotation(
  title = "Percentage of predicted binary responses to t-t stimuli"
)
```

Before saving these plots, let's get the mean percentage for the highest
predicted and lowest predicted values across all the stimulus types

```{r}
binary_response_table3 <- exp2_data_binary_final %>%
  group_by(dimension, v_types_shorthand) %>%
  count(binary_response) %>%
  mutate(percentage = (n/sum(n)*100)) %>%
  rename(count = n,
         percentage = percentage) %>%
  ungroup() %>%
  mutate(dimension = factor(dimension, levels = c("age", "gender", "education", "accent")))

binary_response_table3 %>%
  filter(dimension == "age" & binary_response == "younger" & v_types_shorthand %in% c("cc", "ss", "cs", "sc")) %>%
  summarise(
    manipulation_pair_mean = mean(percentage, na.rm = TRUE),
    manipulation_pair_sd = sd(percentage, na.rm = TRUE)
  )

binary_response_table3 %>%
  filter(dimension == "age" & binary_response == "younger" & v_types_shorthand %in% c("ii", "rr", "ir", "ri")) %>%
  summarise(
    manipulation_pair_mean = mean(percentage, na.rm = TRUE),
    manipulation_pair_sd = sd(percentage, na.rm = TRUE)
  )

binary_response_table3 %>%
  filter(dimension == "gender" & binary_response == "less masculine" & v_types_shorthand %in% c("cc", "rr", "cr", "rc")) %>%
  summarise(
    manipulation_pair_mean = mean(percentage, na.rm = TRUE),
    manipulation_pair_sd = sd(percentage, na.rm = TRUE)
  )

binary_response_table3 %>%
  filter(dimension == "gender" & binary_response == "less masculine" & v_types_shorthand %in% c("ii", "ss", "is", "si")) %>%
  summarise(
    manipulation_pair_mean = mean(percentage, na.rm = TRUE),
    manipulation_pair_sd = sd(percentage, na.rm = TRUE)
  )

binary_response_table3 %>%
  filter(dimension == "education" & binary_response == "less well educated" & v_types_shorthand %in% c("cc", "ss", "cs", "sc")) %>%
  summarise(
    manipulation_pair_mean = mean(percentage, na.rm = TRUE),
    manipulation_pair_sd = sd(percentage, na.rm = TRUE)
  )

binary_response_table3 %>%
  filter(dimension == "education" & binary_response == "less well educated" & v_types_shorthand %in% c("ii", "rr", "ir", "ri")) %>%
  summarise(
    manipulation_pair_mean = mean(percentage, na.rm = TRUE),
    manipulation_pair_sd = sd(percentage, na.rm = TRUE)
  )

binary_response_table3 %>%
  filter(dimension == "accent" & binary_response == "strong NZ accent" & v_types_shorthand %in% c("cc", "ss", "cs", "sc")) %>%
  summarise(
    manipulation_pair_mean = mean(percentage, na.rm = TRUE),
    manipulation_pair_sd = sd(percentage, na.rm = TRUE)
  )

binary_response_table3 %>%
  filter(dimension == "accent" & binary_response == "strong NZ accent" & v_types_shorthand %in% c("ii", "rr", "ir", "ri")) %>%
  summarise(
    manipulation_pair_mean = mean(percentage, na.rm = TRUE),
    manipulation_pair_sd = sd(percentage, na.rm = TRUE)
  )
```

Save the most relevant plots

```{r, eval=FALSE}
ggsave(plot = TRAPTRAP_binary_plot_all, here("plots", "vowel_and_t", "exp2_binary_distribution_plot_VV.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = TRAPt_binary_plot_all, here("plots", "vowel_and_t", "exp2_binary_distribution_plot_Vt.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = tTRAP_binary_plot_all, here("plots", "vowel_and_t", "exp2_binary_distribution_plot_tV.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = tt_binary_plot_all, here("plots", "vowel_and_t", "exp2_binary_distribution_plot_tt.png"), width = 9, height = 6, dpi = 400)
```

### Age model

```{r}
exp2_binary_model_age <- glmer(
  binary_response_numeric ~ variable_same * manipulation_matching * v1_type * variable_1 + (1|participant) + (1|stimulus_voice),
  family = binomial, #removed block and word pair as random effects because of singular fit issue
  data = exp2_data_binary_final_age,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)) #does not converge without optimisation control
)
```

```{r}
summary(exp2_binary_model_age)
```

#### Hypothesis testing

**H1: Social meaning in isolation**

a)  TTii \< TTcc

b)  ttii \< ttcc

```{r}
comparisons(
  exp2_binary_model_age,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t")
  ),
  re.form = NA
)
```

Row 1 is not significant

Row 2 is not significant.

Listeners are not using variants of TRAP or /t/ for age ratings.

**H2: Different variables vs repetition of same variables**

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  exp2_binary_model_age,
  variables = "variable_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(-0.01, 0.01),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "variable_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Because we are not interested in comparisons for this H2, and only
interested in whether there is a significant difference or not, we look
at the `Pr(>|z|)` column for significance

Row 1 is not significant

Row 2 is not significant

Although we predict non-significance for H2 for this experiment, we
should be careful with how we interpret it, given that H1 is not
significant.

**H3: Relative salience of variables**

a)  TTcc != ttcc

b)  TTii != ttii

```{r}
comparisons(
  exp2_binary_model_age,
  variables = "variable_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is also not significant.

This means that TRAP is not more salient than /t/ in age ratings, or
vice versa.

**H4: Order of presentation**

a)  ic \< ci

```{r}
comparisons(
  exp2_binary_model_age,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Row 1 is not significant, meaning there is no order effect.

#### Plots

We plot the binary age data.

```{r}
exp2_data_binary_final_age <- exp2_data_binary_final_age %>% 
  mutate(
    pred_mod2 = predict(exp2_binary_model_age, type = "response"),
  )

exp2_data_binary_final_age %>%
  filter(
    manipulation_matching == TRUE
  ) %>% 
  ggplot(
    aes(
      x = variable_same,
      y = pred_mod2,
      colour = v1_type
    )
  ) +
  geom_boxplot() +
  facet_wrap(~variable_1)
```

```{r}
exp2_data_binary_final_age %>%
  ggplot(
    aes(
      x = factor(binary_response_numeric),
      fill = interaction(manipulation_matching, variable_same)
    )
  ) +
  geom_bar() +
  facet_grid(
    rows = vars(vm2),
    cols = vars(vm1),
    labeller = label_both
  ) +
  labs(
    fill = "man, variable"
  )
```

We plot the relevant model output.

```{r}
plot_comparisons(
  exp2_binary_model_age,
  variables = "variable_same",
  newdata = datagrid(grid_type = "balanced"),
  re.form = NA,
  by = c("v1_type", "manipulation_matching", "variable_1")
)
```

### Gender model

```{r}
exp2_binary_model_gender <- glmer(
  binary_response_numeric ~ variable_same * manipulation_matching * v1_type * variable_1 + (1|participant) + (1|word_pair) + (1|stimulus_voice), #removed block for singular fit issue
  family = binomial,
  data = exp2_data_binary_final_gender,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)) #needs control
)
```

```{r}
summary(exp2_binary_model_gender)
```

#### Hypothesis testing

**H1: Social meaning in isolation**

a)  TTii \< TTcc

b)  ttii \< ttcc

```{r}
comparisons(
  exp2_binary_model_gender,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is significant! (0.0249).

Listeners are not using variants of TRAP for their gender ratings but
they are using variants of /t/!

**H2: Different variables vs repetition of same variables**

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  exp2_binary_model_gender,
  variables = "variable_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(-0.01, 0.01),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "variable_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is not significant.

While this is what we wanted, the interpretation needs to be careful
given H1.

**H3: Relative salience of variables**

a)  TTcc != ttcc

b)  TTii != ttii

```{r}
comparisons(
  exp2_binary_model_gender,
  variables = "variable_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is not significant.

TRAP is not more salient than /t/ for gender ratings and vice versa.

**H4: Order of presentation**

a)  ic \< ci

```{r}
comparisons(
  exp2_binary_model_gender,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Row 1 is significant, meaning there is an order effect!

#### Plots

```{r}
exp2_data_binary_final_gender <- exp2_data_binary_final_gender %>% 
  mutate(
    pred_mod2 = predict(exp2_binary_model_gender, type = "response"),
  )

#plot of H1 and H2
exp2_binary_gender_H1_H2 <- exp2_data_binary_final_gender %>%
  filter(
    manipulation_matching == TRUE,
    #variable_1 == "t"
  ) %>% 
  ggplot(
    aes(
      x = variable_same,
      y = pred_mod2,
      colour = v1_type
    )
  ) +
  facet_wrap(~variable_1) +
  geom_boxplot() +
  ggtitle("Model predictions of H1 and H2 related variables for vowel-and-t binary gender ratings") +
  theme(plot.title = element_text(size = 12)) +
  # t facet, FALSE, Conservative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.15,
    position = position_nudge(x = -0.185),
    geom = "text",
    aes(label = "rc"),
    color = "black",
    size = 5
  ) +
  # t facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.1,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "si"),
    color = "black",
    size = 5
  ) +
  # t facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.11,
    position = position_nudge(x = - 0.18),
    geom = "text",
    aes(label = "rr"),
    color = "black",
    size = 5
  ) +
  # t facet, TRUE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.03,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "ss"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, FALSE, conservative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.125,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "cr"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.08,
    position = position_nudge(x = + 0.2),
    geom = "text",
    aes(label = "is"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.05,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "cc"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, TRUE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.07,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "ii"),
    color = "black",
    size = 5
  )    +
  xlab("same variable") +
  ylab("model predictions\n(higher = more masculine)") +
  theme(
    plot.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 13),
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12)
  ) +
  guides(colour = guide_legend(title = "first variable manipulation")) 

exp2_binary_gender_H1_H2
```

```{r}
exp2_data_binary_final_gender %>%
  ggplot(
    aes(
      x = factor(binary_response_numeric),
      fill = interaction(manipulation_matching, variable_same)
    )
  ) +
  geom_bar() +
  facet_grid(
    rows = vars(vm2),
    cols = vars(vm1),
    labeller = label_both
  ) +
  labs(
    fill = "man, variable"
  )
```

We plot the relevant model output.

```{r}
plot_comparisons(
  exp2_binary_model_gender,
  variables = "variable_same",
  newdata = datagrid(grid_type = "balanced"),
  re.form = NA,
  by = c("v1_type", "manipulation_matching", "variable_1")
)
```

Let's take a closer look at H4, which was not significant but there does
appear to be a significant difference between ci and ic stimuli

```{r}
H4_exp2_binary_gender_plot <- comparisons(
  exp2_binary_model_gender,
  variables = "v1_type",
  newdata = datagrid(
    manipulation_matching = FALSE, 
    variable_1 = c("TRAP", "t"),
    variable_same = c(TRUE, FALSE)
  ),
  re.form=NA
)

H4_exp2_binary_gender_plot %>% 
  mutate(
    condition = case_when(
      variable_1 == "TRAP" & variable_same == TRUE ~ "TRAP-TRAP",
      variable_1 == "TRAP" & variable_same == FALSE ~ "TRAP-t",
      variable_1 == "t" & variable_same == TRUE ~ "t-t",
      variable_1 == "t" & variable_same == FALSE ~ "t-TRAP"
    )
  ) %>%
  ggplot(
    aes(
      x = condition,
      y = estimate,
      ymin = conf.low,
      ymax = conf.high
    ) 
  ) +
  geom_errorbar() +
  geom_point() +
  labs(y = "ic-ci")
```

Because H1 and H4 was significant, let's save these plots.

```{r, eval=FALSE}
ggsave(plot = exp2_binary_gender_H1_H2, here("plots", "vowel_and_t", "exp2_binary_gender_H1_H2.png"), width = 9, height = 6, dpi = 400)
```

### Education model

```{r}
exp2_binary_model_education <- glmer(
  binary_response_numeric ~ variable_same * manipulation_matching * v1_type * variable_1 + (1|participant) + (1|word_pair) + (1|stimulus_voice), #removed block for singular fit warning
  family = binomial,
  data = exp2_data_binary_final_education,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)) #needs control
)
```

```{r}
summary(exp2_binary_model_education)
```

#### Hypothesis testing

**H1: Social meaning in isolation**

a)  TTii \< TTcc

b)  ttii \< ttcc

```{r}
comparisons(
  exp2_binary_model_education,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t")
  ),
  re.form = NA
)
```

Row 1 is significant (0.00101).

Row 2 is significant (\< 0.001).

Listeners are using variants of TRAP and /t/ for education ratings!

**H2: Different variables vs repetition of same variables**

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  exp2_binary_model_education,
  variables = "variable_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(-0.01, 0.01),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "variable_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is not significant.

This is actually what we predicted and is *meaningful* because we can
see from H1 that listeners are using TRAP and /t/ by themselves to
construct social meaning.

**H3: Relative salience of variables**

a)  TTcc != ttcc

b)  TTii != ttii

```{r}
comparisons(
  exp2_binary_model_education,
  variables = "variable_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant

Row 2 is significant, however. The estimate suggests that TTcc\<ttcc,
suggesting that listeners are more likely to rate the speaker as more
well educated for flapped /t/ than conservative TRAP stimuli
(Pr(\>\|z\|) = 0.00285).

So there is a salience effect here too!

**H4: Order of presentation**

a)  ic \< ci

```{r}
comparisons(
  exp2_binary_model_education,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Row 1 is significant (0.00156), so there is also an order effect

#### Plots

```{r}
exp2_data_binary_final_education <- exp2_data_binary_final_education %>% 
  mutate(
    pred_mod2 = predict(exp2_binary_model_education, type = "response"),
  )

#plot of H1 and H2
exp2_binary_education_H1_H2 <- exp2_data_binary_final_education %>%
  filter(
    manipulation_matching == TRUE
  ) %>% 
  ggplot(
    aes(
      x = variable_same,
      y = pred_mod2,
      colour = v1_type
    )
  ) +
  facet_wrap(~variable_1) +
  geom_boxplot() +
  ggtitle("Model predictions of H1 and H2 related variables for vowel-and-t binary education ratings") +
  theme(plot.title = element_text(size = 12)) +
  # t facet, FALSE, Conservative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.035,
    position = position_nudge(x = -0.185),
    geom = "text",
    aes(label = "sc"),
    color = "black",
    size = 5
  ) +
  # t facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.035,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "ri"),
    color = "black",
    size = 5
  ) +
  # t facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.04,
    position = position_nudge(x = - 0.18),
    geom = "text",
    aes(label = "ss"),
    color = "black",
    size = 5
  ) +
  # t facet, TRUE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.05,
    position = position_nudge(x = + 0.19),
    geom = "text",
    aes(label = "rr"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, FALSE, conservative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.05,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "cs"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.04,
    position = position_nudge(x = + 0.2),
    geom = "text",
    aes(label = "ir"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.04,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "cc"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, TRUE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.03,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "ii"),
    color = "black",
    size = 5
  )     +
  xlab("same variable") +
  ylab("model predictions\n(higher = more well educated)") +
  theme(
    plot.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 13),
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12)
  ) +
  guides(colour = guide_legend(title = "first variable manipulation")) 

exp2_binary_education_H1_H2
```

```{r}
exp2_data_binary_final_education %>%
  ggplot(
    aes(
      x = factor(binary_response_numeric),
      fill = interaction(manipulation_matching, variable_same)
    )
  ) +
  geom_bar() +
  facet_grid(
    rows = vars(vm2),
    cols = vars(vm1),
    labeller = label_both
  ) +
  labs(
    fill = "man, variable"
  )
```

We plot the relevant model output.

```{r}
plot_comparisons(
  exp2_binary_model_education,
  variables = "variable_same",
  newdata = datagrid(grid_type = "balanced"),
  re.form = NA,
  by = c("v1_type", "manipulation_matching", "variable_1")
)
```

Let's take a closer look at H4, which was not significant but there does
appear to be a significant difference between ci and ic stimuli

```{r}
H4_exp2_binary_education_plot <- comparisons(
  exp2_binary_model_education,
  variables = "v1_type",
  newdata = datagrid(
    manipulation_matching = FALSE, 
    variable_1 = c("TRAP", "t"),
    variable_same = c(TRUE, FALSE)
  ),
  re.form=NA
)

H4_exp2_binary_education_plot %>% 
  mutate(
    condition = case_when(
      variable_1 == "TRAP" & variable_same == TRUE ~ "TRAP-TRAP",
      variable_1 == "TRAP" & variable_same == FALSE ~ "TRAP-t",
      variable_1 == "t" & variable_same == TRUE ~ "t-t",
      variable_1 == "t" & variable_same == FALSE ~ "t-TRAP"
    )
  ) %>%
  ggplot(
    aes(
      x = condition,
      y = estimate,
      ymin = conf.low,
      ymax = conf.high
    ) 
  ) +
  geom_errorbar() +
  geom_point() +
  labs(y = "ic-ci")
```

Because H1 and H4 was significant, let's save these plots.

```{r, eval=FALSE}
ggsave(plot = exp2_binary_education_H1_H2, here("plots", "vowel_and_t", "exp2_binary_education_H1_H2.png"), width = 9, height = 6, dpi = 400)
```

### Accent model

```{r}
exp2_binary_model_accent <- glmer(
  binary_response_numeric ~ variable_same * manipulation_matching * v1_type * variable_1 + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  family = binomial,
  data = exp2_data_binary_final_accent,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)) #needs control
)
```

```{r}
summary(exp2_binary_model_accent)
```

#### Hypothesis testing

**H1: Social meaning in isolation**

a)  TTii \< TTcc

b)  ttii \< ttcc

```{r}
comparisons(
  exp2_binary_model_accent,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t")
  ),
  re.form = NA
)
```

Row 1 is significant (0.00903).

Row 2 is significant (\< 0.001).

Listeners are using variants of TRAP and /t/ independently for accent
ratings.

**H2: Different variables vs repetition of same variables**

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  exp2_binary_model_accent,
  variables = "variable_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(-0.01, 0.01),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "variable_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is not significant.

This means listeners are not covarying variants of TRAP and /t/ any more
than they are for TRAP and /t/ independently for ratings of accents.

**H3: Relative salience of variables**

a)  TTcc != ttcc

b)  TTii != ttii

```{r}
comparisons(
  exp2_binary_model_accent,
  variables = "variable_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is not significant.

There is no salience effect here.

**H4: Order of presentation**

a)  ic \< ci

```{r}
comparisons(
  exp2_binary_model_accent,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Row 1 is not significant meaning there is no order effect!

#### Plots

```{r}
exp2_data_binary_final_accent <- exp2_data_binary_final_accent %>% 
  mutate(
    pred_mod2 = predict(exp2_binary_model_accent, type = "response"),
  )

#plot of H1 and H2
exp2_binary_accent_H1_H2 <- exp2_data_binary_final_accent %>%
  filter(
    manipulation_matching == TRUE
  ) %>% 
  ggplot(
    aes(
      x = variable_same,
      y = pred_mod2,
      colour = v1_type
    )
  ) +
  facet_wrap(~variable_1) +
  geom_boxplot() +
  ggtitle("Model predictions of H1 and H2 related variables for vowel-and-t binary accent ratings") +
  theme(plot.title = element_text(size = 12)) +
  # t facet, FALSE, Conservative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.035,
    position = position_nudge(x = -0.185),
    geom = "text",
    aes(label = "sc"),
    color = "black",
    size = 5
  ) +
  # t facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.035,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "ri"),
    color = "black",
    size = 5
  ) +
  # t facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.04,
    position = position_nudge(x = - 0.18),
    geom = "text",
    aes(label = "ss"),
    color = "black",
    size = 5
  ) +
  # t facet, TRUE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.04,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "rr"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, FALSE, conservative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.035,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "cs"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = + 0.2),
    geom = "text",
    aes(label = "ir"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.04,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "cc"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, TRUE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "ii"),
    color = "black",
    size = 5
  )     +
  xlab("same variable") +
  ylab("model predictions\n(higher = not strong NZ accent)") +
  theme(
    plot.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 13),
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12)
  ) +
  guides(colour = guide_legend(title = "first variable manipulation")) 

exp2_binary_accent_H1_H2
```

```{r}
exp2_data_binary_final_accent %>%
  ggplot(
    aes(
      x = factor(binary_response_numeric),
      fill = interaction(manipulation_matching, variable_same)
    )
  ) +
  geom_bar() +
  facet_grid(
    rows = vars(vm2),
    cols = vars(vm1),
    labeller = label_both
  ) +
  labs(
    fill = "man, variable"
  )
```

We plot the relevant model output.

```{r}
plot_comparisons(
  exp2_binary_model_accent,
  variables = "variable_same",
  newdata = datagrid(grid_type = "balanced"),
  re.form = NA,
  by = c("v1_type", "manipulation_matching", "variable_1")
)
```

Because H1 was significant, let's save these plots.

```{r, eval=FALSE}
ggsave(plot = exp2_binary_accent_H1_H2, here("plots", "vowel_and_t", "exp2_binary_accent_H1_H2.png"), width = 9, height = 6, dpi = 400)
```

## Slider analysis

Now that we have our analysis of the binary forced-choice data, we can
move onto a linear regression model of the slider data.

We split the analysis up by each the social demographic. So let's split
up the `exp2_data_slider_final` into the four social dimensions

```{r}
exp2_data_slider_final_age <- exp2_data_slider_final %>%
  filter(grepl(('old'), prompt))

exp2_data_slider_final_gender <- exp2_data_slider_final %>%
  filter(grepl(('masculine'), prompt))

exp2_data_slider_final_education <- exp2_data_slider_final %>%
  filter(grepl(('educated'), prompt))

exp2_data_slider_final_accent <- exp2_data_slider_final %>%
  filter(grepl(('accented'), prompt))

#because accent goes in the opposite direction, we need to inverse the ratings
exp2_data_slider_final_accent <- exp2_data_slider_final_accent %>%
 mutate(slider_response_inverse = 1-(slider_response))

exp2_data_slider_final$values_for_plotting <- ifelse(
  exp2_data_slider_final$dimension == 'accent',
      1 - exp2_data_slider_final$slider_response,
      exp2_data_slider_final$slider_response)

```

Like the binary data, let's check the distribution of just some of this
data.

```{r}
exp2_data_slider_final$dimension <- factor(exp2_data_slider_final$dimension, levels=c('age', 'gender', 'education', 'accent'))

exp2_data_slider_final %>%
  select(dimension, values_for_plotting, v_types_shorthand) %>%
  group_by(dimension, v_types_shorthand) %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_slider_distribution <- exp2_data_slider_final %>%
  ggplot(aes(x=factor(dimension, level = c('age', 'gender', 'education', 'accent')), y=slider_response, fill=dimension)) + 
    geom_violin() +
    geom_boxplot(width = 0.3) +
    theme(legend.position="none") +
    xlab("Rating dimension") +
    ylab("Slider responses") +
  ggtitle("Violin distribution of responses to slider task for all social ratings") 

exp2_slider_distribution #this looks pretty even, which is what we want to see :)

# Custom y-axis labels for plots below
y_labels <- c("0.0", "0.5", "1.0")

```

```{r}
#TRAPTRAP plot
TRAPTRAP_slider_age <- exp2_data_slider_final %>%
  filter(dimension == "age") %>%
  filter(v_types_shorthand %in% c("cc", "ci", "ic", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot() +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("AGE") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))

TRAPTRAP_slider_age 

TRAPTRAP_slider_gender <- exp2_data_slider_final %>%
  filter(dimension == "gender") %>%
  filter(v_types_shorthand %in% c("cc", "ci", "ic", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#7CAE00") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("GENDER") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))

TRAPTRAP_slider_gender

TRAPTRAP_slider_education <- exp2_data_slider_final %>%
  filter(dimension == "education") %>%
  filter(v_types_shorthand %in% c("cc", "ci", "ic", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#00BFC4") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("EDUCATION") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))

TRAPTRAP_slider_education

TRAPTRAP_slider_accent <- exp2_data_slider_final %>%
  filter(dimension == "accent") %>%
  filter(v_types_shorthand %in% c("cc", "ci", "ic", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#C77CFF") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("ACCENT") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))

TRAPTRAP_slider_accent

TRAPTRAP_slider_plot_all <- (TRAPTRAP_slider_age + TRAPTRAP_slider_gender) / (TRAPTRAP_slider_education + TRAPTRAP_slider_accent)

TRAPTRAP_slider_plot_all + plot_annotation(
  title = "Boxplot of slider responses to TRAP-TRAP stimuli"
)

```

```{r}
#TRAPt plot
TRAPt_slider_age <- exp2_data_slider_final %>%
  filter(dimension == "age") %>%
  filter(v_types_shorthand %in% c("cr", "cs", "ir", "is")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("cs", "cr", "is", "ir"))) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot() +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("AGE") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))

TRAPt_slider_age 

TRAPt_slider_gender <- exp2_data_slider_final %>%
  filter(dimension == "gender") %>%
  filter(v_types_shorthand %in% c("cr", "cs", "ir", "is")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#7CAE00") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("GENDER") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))

TRAPt_slider_gender

TRAPt_slider_education <- exp2_data_slider_final %>%
  filter(dimension == "education") %>%
  filter(v_types_shorthand %in% c("cr", "cs", "ir", "is")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("cs", "cr", "is", "ir"))) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#00BFC4") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("EDUCATION") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))

TRAPt_slider_education

TRAPt_slider_accent <- exp2_data_slider_final %>%
  filter(dimension == "accent") %>%
  filter(v_types_shorthand %in% c("cr", "cs", "ir", "is")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("cs", "cr", "is", "ir"))) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#C77CFF") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("ACCENT") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))

TRAPt_slider_accent

TRAPt_slider_plot_all <- (TRAPt_slider_age + TRAPt_slider_gender) / (TRAPt_slider_education + TRAPt_slider_accent)

TRAPt_slider_plot_all + plot_annotation(
  title = "Boxplot of slider responses to TRAP-t stimuli"
)

```

```{r}
#tTRAP plot
tTRAP_slider_age <- exp2_data_slider_final %>%
  filter(dimension == "age") %>%
  filter(v_types_shorthand %in% c("rc", "sc", "ri", "si")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("sc", "si", "rc", "ri"))) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot() +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("AGE") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))

tTRAP_slider_age 

tTRAP_slider_gender <- exp2_data_slider_final %>%
  filter(dimension == "gender") %>%
  filter(v_types_shorthand %in% c("rc", "sc", "ri", "si")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#7CAE00") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("GENDER") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))

tTRAP_slider_gender

tTRAP_slider_education <- exp2_data_slider_final %>%
  filter(dimension == "education") %>%
  filter(v_types_shorthand %in% c("rc", "sc", "ri", "si")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("sc", "si", "rc", "ri"))) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#00BFC4") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("EDUCATION") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))

tTRAP_slider_education

tTRAP_slider_accent <- exp2_data_slider_final %>%
  filter(dimension == "accent") %>%
  filter(v_types_shorthand %in% c("rc", "sc", "ri", "si")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("sc", "si", "rc", "ri"))) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#C77CFF") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("ACCENT") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))

tTRAP_slider_accent

tTRAP_slider_plot_all <- (tTRAP_slider_age + tTRAP_slider_gender) / (tTRAP_slider_education + tTRAP_slider_accent)

tTRAP_slider_plot_all + plot_annotation(
  title = "Boxplot of slider responses to t-TRAP stimuli"
)

```

```{r}
#tt plot
tt_slider_age <- exp2_data_slider_final %>%
  filter(dimension == "age") %>%
  filter(v_types_shorthand %in% c("rr", "sr", "rs", "ss")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("ss", "sr", "rs", "rr"))) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot() +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("AGE") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))

tt_slider_age 

tt_slider_gender <- exp2_data_slider_final %>%
  filter(dimension == "gender") %>%
  filter(v_types_shorthand %in% c("rr", "sr", "rs", "ss")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#7CAE00") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("GENDER") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))

tt_slider_gender

tt_slider_education <- exp2_data_slider_final %>%
  filter(dimension == "education") %>%
  filter(v_types_shorthand %in% c("rr", "sr", "rs", "ss")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("ss", "sr", "rs", "rr"))) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#00BFC4") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("EDUCATION") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))

tt_slider_education

tt_slider_accent <- exp2_data_slider_final %>%
  filter(dimension == "accent") %>%
  filter(v_types_shorthand %in% c("rr", "sr", "rs", "ss")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("ss", "sr", "rs", "rr"))) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#C77CFF") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("ACCENT") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0), labels = y_labels) +
    geom_segment(aes(x = 1, y = 1.4, xend = 4, yend = 1.1), size = 1, color = "gray46",
                  arrow = arrow(length = unit(0.5, "cm"))) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold"))

tt_slider_accent

tt_slider_plot_all <- (tt_slider_age + tt_slider_gender) / (tt_slider_education + tt_slider_accent)

tt_slider_plot_all + plot_annotation(
  title = "Boxplot of slider responses to t-t stimuli"
)

```

Just before saving, let's look at the means for groups of manipulations

```{r}
#we can see the group means for certain factors
exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("cc","ss", "cs", "sc") & dimension == "age") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("ii","rr", "ir", "ri") & dimension == "age") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("cc","rr", "cr", "rc") & dimension == "gender") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("ii","ss", "is", "ss") & dimension == "gender") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("cc","ss", "cs", "sc") & dimension == "education") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("ii","rr", "ir", "ri") & dimension == "education") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("cc","ss", "cs", "sc") & dimension == "accent") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("ii","rr", "ir", "ri") & dimension == "accent") %>%
  summarise(slider_mean = mean(values_for_plotting))
```

```{r, eval=FALSE}
ggsave(plot = TRAPTRAP_slider_plot_all, here("plots", "vowel_and_t", "exp2_slider_distribution_plot_VV.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = TRAPt_slider_plot_all, here("plots", "vowel_and_t", "exp2_slider_distribution_plot_Vt.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = tTRAP_slider_plot_all, here("plots", "vowel_and_t", "exp2_slider_distribution_plot_tV.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = tt_slider_plot_all, here("plots", "vowel_and_t", "exp2_slider_distribution_plot_tt.png"), width = 9, height = 6, dpi = 400)
```

It could also be good to get a sense of the slider variations per
dimension to see how much people were using the slider

```{r}
exp2_data_slider_final %>%
  select(dimension, values_for_plotting) %>%
  group_by(dimension) %>%
  summarise(slider_mean = mean(values_for_plotting),
            slider_variation = sd(values_for_plotting))
```

### Age model

```{r}
exp2_slider_model_age <- lmer(
  slider_response ~ variable_same * manipulation_matching * v1_type * variable_1 + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp2_data_slider_final_age,
) 
```

```{r}
summary(exp2_slider_model_age)
```

#### Hypothesis testing

**H1: Social meaning in isolation**

a)  TTii \< TTcc

b)  ttii \< ttcc

```{r}
comparisons(
  exp2_slider_model_age,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is not significant.

Listeners are not using variants of TRAP or /t/ for age ratings.

**H2: Different variables vs repetition of same variables**

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  exp2_slider_model_age,
  variables = "variable_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(-0.01, 0.01),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "variable_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 teis not significant.

This should be carefully interpreted!

**H3: Relative salience of variables**

a)  TTcc != ttcc

b)  TTii != ttii

```{r}
comparisons(
  exp2_slider_model_age,
  variables = "variable_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is not significant.

There is no salience effect here.

**H4: Order of presentation**

a)  ic \< ci

```{r}
comparisons(
  exp2_slider_model_age,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Row 1 is not significant.

#### Plots

```{r}
plot_comparisons(
  exp2_slider_model_age,
  variables = "variable_same",
  newdata = datagrid(grid_type = "balanced"),
  re.form = NA,
  by = c("v1_type", "manipulation_matching", "variable_1")
)
```

### Gender model

```{r}
exp2_slider_model_gender <- lmer(
  slider_response ~ variable_same * manipulation_matching * v1_type * variable_1 + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp2_data_slider_final_gender #removed block
)
```

```{r}
summary(exp2_slider_model_gender)
```

#### Hypothesis testing

**H1: Social meaning in isolation**

a)  TTii \< TTcc

b)  ttii \< ttcc

```{r}
comparisons(
  exp2_slider_model_gender,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is not significant.

Listeners are not using variants of TRAP and /t/ independently for
gender ratings.

**H2: Different variables vs repetition of same variables**

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  exp2_slider_model_gender,
  variables = "variable_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(-0.01, 0.01),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "variable_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is not significant.

**H3: Relative salience of variables**

a)  TTcc != ttcc

b)  TTii != ttii

```{r}
comparisons(
  exp2_slider_model_gender,
  variables = "variable_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is not significant.

This means there is no salience effect!

**H4: Order of presentation**

a)  ic \< ci

```{r}
comparisons(
  exp2_slider_model_gender,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Row 1 is not significant, meaning there is no order effect!

#### Plots

```{r}
plot_comparisons(
  exp2_slider_model_gender,
  variables = "variable_same",
  newdata = datagrid(grid_type = "balanced"),
  re.form = NA,
  by = c("v1_type", "manipulation_matching", "variable_1")
)
```

### Education model

```{r}
exp2_slider_model_education <- lmer(
  slider_response ~ variable_same * manipulation_matching * v1_type * variable_1 + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp2_data_slider_final_education
)
```

```{r}
summary(exp2_slider_model_education)
```

#### Hypothesis testing

**H1: Social meaning in isolation**

a)  TTii \< TTcc

b)  ttii \< ttcc

```{r}
comparisons(
  exp2_slider_model_education,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t")
  ),
  re.form = NA
)
```

Row 1 is significant.

Row 2 is significant.

Listeners are using variants of TRAP and /t/ for education ratings.

**H2: Different variables vs repetition of same variables**

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  exp2_slider_model_education,
  variables = "variable_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(-0.01, 0.01),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "variable_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant

Row 2 is not significant - but close! (0.0735)

**H3: Relative salience of variables**

a)  TTcc != ttcc

b)  TTii != ttii

```{r}
comparisons(
  exp2_slider_model_education,
  variables = "variable_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is significance.

There is a significant salience effect but only for conservative
variants.

**H4: Order of presentation**

a)  ic \< ci

```{r}
comparisons(
  exp2_slider_model_education,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Row 1 is not significant, meaning there is no order effect.

#### Plots

```{r}
exp2_data_slider_final_education <- exp2_data_slider_final_education %>% 
  mutate(
    pred_mod2 = predict(exp2_slider_model_education, type = "response"),
  )

#plot of H1 and H2
exp2_slider_education_H1_H2 <- exp2_data_slider_final_education %>%
  filter(
    manipulation_matching == TRUE
  ) %>% 
  ggplot(
    aes(
      x = variable_same,
      y = pred_mod2,
      colour = v1_type
    )
  ) +
  facet_wrap(~variable_1) +
  geom_boxplot() +
  ggtitle("Model predictions of H1 and H2 related variables for vowel-and-t slider education ratings") +
  theme(plot.title = element_text(size = 12)) +
  # t facet, FALSE, Conservative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.0225,
    position = position_nudge(x = -0.185),
    geom = "text",
    aes(label = "sc"),
    color = "black",
    size = 5
  ) +
  # t facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.0225,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "ri"),
    color = "black",
    size = 5
  ) +
  # t facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = - 0.18),
    geom = "text",
    aes(label = "ss"),
    color = "black",
    size = 5
  ) +
  # t facet, TRUE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.0225,
    position = position_nudge(x = + 0.19),
    geom = "text",
    aes(label = "rr"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, FALSE, conservative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.0175,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "cs"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = + 0.2),
    geom = "text",
    aes(label = "ir"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.025,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "cc"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, TRUE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.02,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "ii"),
    color = "black",
    size = 5
  )      +
  xlab("same variable") +
  ylab("model predictions\n(higher = more well educated)") +
  theme(
    plot.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 13),
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12)
  ) +
  guides(colour = guide_legend(title = "first variable manipulation")) 

exp2_slider_education_H1_H2
```

```{r}
plot_comparisons(
  exp2_slider_model_education,
  variables = "variable_same",
  newdata = datagrid(grid_type = "balanced"),
  re.form = NA,
  by = c("v1_type", "manipulation_matching", "variable_1")
)
```

Because H1 was significant, let's save these plots.

```{r, eval=FALSE}
ggsave(plot = exp2_slider_education_H1_H2, here("plots", "vowel_and_t", "exp2_slider_education_H1_H2.png"), width = 9, height = 6, dpi = 400)
```

### Accent model

```{r}
exp2_slider_model_accent <- lmer(
  slider_response_inverse ~ variable_same * manipulation_matching * v1_type * variable_1 + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp2_data_slider_final_accent
) #using the inverse data here
```

```{r}
summary(exp2_slider_model_accent)
```

#### Hypothesis testing

**H1: Social meaning in isolation**

a)  TTii \< TTcc

b)  ttii \< ttcc

```{r}
comparisons(
  exp2_slider_model_accent,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t")
  ),
  re.form = NA
)
```

Row 1 is significant.

Row 2 is significant.

Listeners are using variants of TRAP and /t/ for accent ratings.

**H2: Different variables vs repetition of same variables**

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  exp2_slider_model_accent,
  variables = "variable_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(-0.01, 0.01),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "variable_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is not significant.

Listeners are not covarying variants of TRAP and /t/ any more than they
are for TRAP and /t/ independently for accent ratings.

**H3: Relative salience of variables**

a)  TTcc != ttcc

b)  TTii != ttii

```{r}
comparisons(
  exp2_slider_model_accent,
  variables = "variable_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative")
  ),
  re.form = NA
)
```

Row 1 is not significant.

Row 2 is not significant.

There is no salience effect.

**H4: Order of presentation**

a)  ic \< ci

```{r}
comparisons(
  exp2_slider_model_accent,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = FALSE
  ),
  re.form = NA
)
```

Row 1 is not significant, meaning there is no order effect.

#### Plots

```{r}
exp2_data_slider_final_accent <- exp2_data_slider_final_accent %>% 
  mutate(
    pred_mod2 = predict(exp2_slider_model_accent, type = "response"),
  )

#plot of H1 and H2
exp2_slider_accent_H1_H2 <- exp2_data_slider_final_accent %>%
  filter(
    manipulation_matching == TRUE
  ) %>% 
  ggplot(
    aes(
      x = variable_same,
      y = pred_mod2,
      colour = v1_type
    )
  ) +
  facet_wrap(~variable_1) +
  geom_boxplot() +
  ggtitle("Model predictions of H1 and H2 related variables for vowel-and-t slider accent ratings") +
  theme(plot.title = element_text(size = 12)) +
  # t facet, FALSE, Conservative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.04,
    position = position_nudge(x = -0.185),
    geom = "text",
    aes(label = "sc"),
    color = "black",
    size = 5
  ) +
  # t facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.04,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "ri"),
    color = "black",
    size = 5
  ) +
  # t facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.04,
    position = position_nudge(x = - 0.18),
    geom = "text",
    aes(label = "ss"),
    color = "black",
    size = 5
  ) +
  # t facet, TRUE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "t" & variable_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.04,
    position = position_nudge(x = + 0.19),
    geom = "text",
    aes(label = "rr"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, FALSE, conservative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "FALSE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.035,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "cs"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, FALSE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "FALSE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.05,
    position = position_nudge(x = + 0.2),
    geom = "text",
    aes(label = "ir"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, TRUE, conservative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "TRUE" & v1_type == "Conservative"),
    fun = function(x) mean(x) + 0.035,
    position = position_nudge(x = - 0.185),
    geom = "text",
    aes(label = "cc"),
    color = "black",
    size = 5
  ) +
  # TRAP facet, TRUE, innovative
  stat_summary(
    data = . %>% filter(variable_1 == "TRAP" & variable_same == "TRUE" & v1_type == "Innovative"),
    fun = function(x) mean(x) + 0.035,
    position = position_nudge(x = + 0.185),
    geom = "text",
    aes(label = "ii"),
    color = "black",
    size = 5
  )      +
  xlab("same variable") +
  ylab("model predictions\n(higher = not strong NZ accent)") +
  theme(
    plot.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 13),
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12)
  ) +
  guides(colour = guide_legend(title = "first variable manipulation")) 

exp2_slider_accent_H1_H2
```

```{r}
plot_comparisons(
  exp2_slider_model_education,
  variables = "variable_same",
  newdata = datagrid(grid_type = "balanced"),
  re.form = NA,
  by = c("v1_type", "manipulation_matching", "variable_1")
)
```

Because H1 was significant, let's save these plots.

```{r, eval=FALSE}
ggsave(plot = exp2_slider_accent_H1_H2, here("plots", "vowel_and_t", "exp2_slider_accent_H1_H2.png"), width = 9, height = 6, dpi = 400)
```

## Post hoc analysis

Like the previous experiment, we should do some post hoc analysis to
explore the data more.

Here are some things we should check out:

-   rating for each task by *speaker* and *condition*

-   investigating the *free textbox comments* to see how they
    corroborate with the results (and looking into the results form
    participants who left relevant comments)

-   *pitch analysis* of speakers

### Speaker investigation

```{r}
binary_response_speaker <- exp2_data_binary_final %>%
  group_by(dimension, stimulus_voice) %>%
  count(binary_response) %>%
  mutate(percentage = (n/sum(n)*100)) %>%
  rename(count = n,
         percentage = percentage) %>%
  ungroup() %>%
  mutate(dimension = factor(dimension, levels = c("age", "gender", "education", "accent")))

binary_response_table3$Rounded = round(binary_response_table3$percentage,2)

binary_speaker_plot1 <- binary_response_speaker %>%
  ggplot(aes(x=factor(binary_response, level = c('younger', 'older', 'less masculine', 'more masculine', 'less well educated', 'more well educated', 'strong NZ accent', 'not strong NZ accent')), y=percentage, fill=dimension)) + 
  geom_bar(stat = "identity") +
  #geom_text(aes(label=Rounded),vjust = -0.25)+
  #guides(fill="none") +
  xlab("Forced-choice response") +
  ylab("Percentage") +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  facet_wrap(~stimulus_voice)

binary_speaker_plot1 #okay turns out what I thought would happen is happening for p01 (lowest pitch) and p08 (highest pitch) in terms of responses to the age and gender dimension

```

```{r}
binary_response_table3 <- exp2_data_binary_final %>%
  group_by(dimension, v_types_shorthand, stimulus_voice) %>%
  count(binary_response) %>%
  mutate(percentage = (n/sum(n)*100)) %>%
  rename(count = n,
         percentage = percentage) %>%
  ungroup() %>%
  mutate(dimension = factor(dimension, levels = c("age", "gender", "education", "accent"))) %>%
  mutate(speaker = fct_recode(stimulus_voice, 
                              "speaker1" = "p01",
                              "speaker4" = "p04",
                              "speaker5" = "p05", 
                              "speaker6" = "p06",
                              "speaker7" = "p07",
                              "speaker8" = "p08"))

binary_response_table3$Rounded = round(binary_response_table3$percentage,2)

binary_response_table3$dimension <- factor(binary_response_table3$dimension, levels=c('age', 'gender', 'education', 'accent'))

binary_response_table3$binary_response <- factor(binary_response_table3$binary_response, levels=c('older','younger', 'less masculine', 'more masculine', 'less well educated', 'more well educated', 'not strong NZ accent', 'strong NZ accent'))

#and let's get some means for writing
binary_response_table3 %>%
  filter(speaker == "speaker1" & dimension == "age" & binary_response == "younger" & v_types_shorthand %in% c("cc", "cs", "sc", "ss")) %>%
  summarise(
    manipulation_pair_mean = mean(percentage, na.rm = TRUE),
    manipulation_pair_sd = sd(percentage, na.rm = TRUE)
  )

binary_response_table3 %>%
  filter(speaker == "speaker8" & dimension == "age" & binary_response == "younger" & v_types_shorthand %in% c("cc", "cs", "sc", "ss")) %>%
  summarise(
    manipulation_pair_mean = mean(percentage, na.rm = TRUE),
    manipulation_pair_sd = sd(percentage, na.rm = TRUE)
  )

binary_response_table3 %>%
  filter(speaker == "speaker1" & dimension == "age" & binary_response == "younger" & v_types_shorthand %in% c("ii", "ir", "ri", "rr")) %>%
  summarise(
    manipulation_pair_mean = mean(percentage, na.rm = TRUE),
    manipulation_pair_sd = sd(percentage, na.rm = TRUE)
  )

binary_response_table3 %>%
  filter(speaker == "speaker8" & dimension == "age" & binary_response == "younger" & v_types_shorthand %in% c("ii", "ir", "ri", "rr")) %>%
  summarise(
    manipulation_pair_mean = mean(percentage, na.rm = TRUE),
    manipulation_pair_sd = sd(percentage, na.rm = TRUE)
  )

binary_response_table3 %>%
  filter(speaker == "speaker1" & dimension == "gender" & binary_response == "less masculine" & v_types_shorthand %in% c("cc", "cr", "rc", "rr")) %>%
  summarise(
    manipulation_pair_mean = mean(percentage, na.rm = TRUE),
    manipulation_pair_sd = sd(percentage, na.rm = TRUE)
  )

binary_response_table3 %>%
  filter(speaker == "speaker8" & dimension == "gender" & binary_response == "less masculine" & v_types_shorthand %in% c("cc", "cr", "rc", "rr")) %>%
  summarise(
    manipulation_pair_mean = mean(percentage, na.rm = TRUE),
    manipulation_pair_sd = sd(percentage, na.rm = TRUE)
  )

binary_response_table3 %>%
  filter(speaker == "speaker1" & dimension == "gender" & binary_response == "less masculine" & v_types_shorthand %in% c("ii", "is", "si", "ss")) %>%
  summarise(
    manipulation_pair_mean = mean(percentage, na.rm = TRUE),
    manipulation_pair_sd = sd(percentage, na.rm = TRUE)
  )

binary_response_table3 %>%
  filter(speaker == "speaker8" & dimension == "gender" & binary_response == "less masculine" & v_types_shorthand %in% c("ii", "is", "si", "ss")) %>%
  summarise(
    manipulation_pair_mean = mean(percentage, na.rm = TRUE),
    manipulation_pair_sd = sd(percentage, na.rm = TRUE)
  )

```

```{r}
#TT stimuli
binary_speaker_plot_TRAPTRAP_age <- binary_response_table3 %>%
  filter(binary_response %in% c('younger')) %>%
  filter(v_types_shorthand %in% c("cc", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'younger' responses") +
  ylim(0,100) +
  facet_grid(cols=vars(speaker)) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

binary_speaker_plot_TRAPTRAP_age

binary_speaker_plot_TRAPTRAP_gender <- binary_response_table3 %>%
  filter(binary_response %in% c('less masculine')) %>%
  filter(v_types_shorthand %in% c("cc", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  geom_bar(stat = "identity", fill="#7CAE00") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'less masculine' responses") +
  ylim(0,100) +
  facet_grid(cols=vars(speaker)) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

binary_speaker_plot_TRAPTRAP_gender

binary_speaker_plot_TRAPTRAP_education <- binary_response_table3 %>%
  filter(binary_response %in% c('less well educated')) %>%
  filter(v_types_shorthand %in% c("cc", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  geom_bar(stat = "identity", fill="#00BFC4") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'less well educated' responses") +
  ylim(0,100) +
  facet_grid(cols=vars(speaker)) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

binary_speaker_plot_TRAPTRAP_education

binary_speaker_plot_TRAPTRAP_accent <- binary_response_table3 %>%
  filter(binary_response %in% c('strong NZ accent')) %>%
  filter(v_types_shorthand %in% c("cc", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  geom_bar(stat = "identity", fill="#C77CFF") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'strong NZ accent' responses") +
  ylim(0,100) +
  facet_grid(cols=vars(speaker)) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

binary_speaker_plot_TRAPTRAP_accent

TRAPTRAP_binary_speakers_plot <- (binary_speaker_plot_TRAPTRAP_age) + (binary_speaker_plot_TRAPTRAP_gender) + (binary_speaker_plot_TRAPTRAP_education) + (binary_speaker_plot_TRAPTRAP_accent)

TRAPTRAP_binary_speakers_plot + plot_annotation(
  title = "Percentage of binary responses to TRAP-TRAP stimuli for each speaker"
)

```

```{r}
#Tt stimuli
binary_speaker_plot_TRAPt_age <- binary_response_table3 %>%
  filter(binary_response %in% c('younger')) %>%
  filter(v_types_shorthand %in% c("cs", "ir")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'younger' responses") +
  ylim(0,100) +
  facet_grid(cols=vars(speaker)) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

binary_speaker_plot_TRAPt_age

binary_speaker_plot_TRAPt_gender <- binary_response_table3 %>%
  filter(binary_response %in% c('less masculine')) %>%
  filter(v_types_shorthand %in% c("cr", "is")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  geom_bar(stat = "identity", fill="#7CAE00") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'less masculine' responses") +
  ylim(0,100) +
  facet_grid(cols=vars(speaker)) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

binary_speaker_plot_TRAPt_gender

binary_speaker_plot_TRAPt_education <- binary_response_table3 %>%
  filter(binary_response %in% c('less well educated')) %>%
  filter(v_types_shorthand %in% c("cs", "ir")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  geom_bar(stat = "identity", fill="#00BFC4") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'less well educated' responses") +
  ylim(0,100) +
  facet_grid(cols=vars(speaker)) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

binary_speaker_plot_TRAPt_education

binary_speaker_plot_TRAPt_accent <- binary_response_table3 %>%
  filter(binary_response %in% c('strong NZ accent')) %>%
  filter(v_types_shorthand %in% c("cs", "ir")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  geom_bar(stat = "identity", fill="#C77CFF") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'strong NZ accent' responses") +
  ylim(0,100) +
  facet_grid(cols=vars(speaker)) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

binary_speaker_plot_TRAPt_accent

TRAPt_binary_speakers_plot <- (binary_speaker_plot_TRAPt_age) + (binary_speaker_plot_TRAPt_gender) + (binary_speaker_plot_TRAPt_education) + (binary_speaker_plot_TRAPt_accent)

TRAPt_binary_speakers_plot + plot_annotation(
  title = "Percentage of binary responses to TRAP-t stimuli for each speaker"
)

```

```{r}
#tT stimuli
binary_speaker_plot_tTRAP_age <- binary_response_table3 %>%
  filter(binary_response %in% c('younger')) %>%
  filter(v_types_shorthand %in% c("sc", "ri")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("sc", "ri"))) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'younger' responses") +
  ylim(0,100) +
  facet_grid(cols=vars(speaker)) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

binary_speaker_plot_tTRAP_age

binary_speaker_plot_tTRAP_gender <- binary_response_table3 %>%
  filter(binary_response %in% c('less masculine')) %>%
  filter(v_types_shorthand %in% c("rc", "si")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  geom_bar(stat = "identity", fill="#7CAE00") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'less masculine' responses") +
  ylim(0,100) +
  facet_grid(cols=vars(speaker)) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

binary_speaker_plot_tTRAP_gender

binary_speaker_plot_tTRAP_education <- binary_response_table3 %>%
  filter(binary_response %in% c('less well educated')) %>%
  filter(v_types_shorthand %in% c("sc", "ri")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("sc", "ri"))) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  geom_bar(stat = "identity", fill="#00BFC4") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'less well educated' responses") +
  ylim(0,100) +
  facet_grid(cols=vars(speaker)) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

binary_speaker_plot_tTRAP_education

binary_speaker_plot_tTRAP_accent <- binary_response_table3 %>%
  filter(binary_response %in% c('strong NZ accent')) %>%
  filter(v_types_shorthand %in% c("sc", "ri")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("sc", "ri"))) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  geom_bar(stat = "identity", fill="#C77CFF") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'strong NZ accent' responses") +
  ylim(0,100) +
  facet_grid(cols=vars(speaker)) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

binary_speaker_plot_tTRAP_accent

tTRAP_binary_speakers_plot <- (binary_speaker_plot_tTRAP_age) + (binary_speaker_plot_tTRAP_gender) + (binary_speaker_plot_tTRAP_education) + (binary_speaker_plot_tTRAP_accent)

tTRAP_binary_speakers_plot + plot_annotation(
  title = "Percentage of binary responses to t-TRAP stimuli for each speaker"
)

```

```{r}
#tt stimuli
binary_speaker_plot_tt_age <- binary_response_table3 %>%
  filter(binary_response %in% c('younger')) %>%
  filter(v_types_shorthand %in% c("ss", "rr")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("ss", "rr"))) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'younger' responses") +
  ylim(0,100) +
  facet_grid(cols=vars(speaker)) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

binary_speaker_plot_tt_age

binary_speaker_plot_tt_gender <- binary_response_table3 %>%
  filter(binary_response %in% c('less masculine')) %>%
  filter(v_types_shorthand %in% c("rr", "ss")) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  geom_bar(stat = "identity", fill="#7CAE00") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'less masculine' responses") +
  ylim(0,100) +
  facet_grid(cols=vars(speaker)) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

binary_speaker_plot_tt_gender

binary_speaker_plot_tt_education <- binary_response_table3 %>%
  filter(binary_response %in% c('less well educated')) %>%
  filter(v_types_shorthand %in% c("ss", "rr")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("ss", "rr"))) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  geom_bar(stat = "identity", fill="#00BFC4") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'less well educated' responses") +
  ylim(0,100) +
  facet_grid(cols=vars(speaker)) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

binary_speaker_plot_tt_education

binary_speaker_plot_tt_accent <- binary_response_table3 %>%
  filter(binary_response %in% c('strong NZ accent')) %>%
  filter(v_types_shorthand %in% c("ss", "rr")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("ss", "rr"))) %>%
  ggplot(aes(x=v_types_shorthand, y=percentage, fill=binary_response)) + 
  geom_bar(stat = "identity") +
  geom_bar(stat = "identity", fill="#C77CFF") +
  guides(fill="none") +
  xlab("Manipulation pair") +
  ylab("Percentage") +
  ggtitle("'strong NZ accent' responses") +
  ylim(0,100) +
  facet_grid(cols=vars(speaker)) +
  theme_gray() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

binary_speaker_plot_tt_accent

tt_binary_speakers_plot <- (binary_speaker_plot_tt_age) + (binary_speaker_plot_tt_gender) + (binary_speaker_plot_tt_education) + (binary_speaker_plot_tt_accent)

tt_binary_speakers_plot + plot_annotation(
  title = "Percentage of binary responses to t-t stimuli for each speaker"
)

```

```{r, eval=FALSE}
ggsave(plot = TRAPTRAP_binary_speakers_plot, here("plots", "vowel_and_t", "exp2_TRAPTRAP_binary_speakers_plot.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = TRAPt_binary_speakers_plot, here("plots", "vowel_and_t", "exp2_TRAPt_binary_speakers_plot.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = tTRAP_binary_speakers_plot, here("plots", "vowel_and_t", "exp2_tTRAP_binary_speakers_plot.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = tt_binary_speakers_plot, here("plots", "vowel_and_t", "exp2_tt_binary_speakers_plot.png"), width = 9, height = 6, dpi = 400)
```

And now the same for the slider data

```{r}
exp2_data_slider_final <- exp2_data_slider_final %>%
  mutate(speaker = fct_recode(stimulus_voice, 
                              "speaker1" = "p01",
                              "speaker4" = "p04",
                              "speaker5" = "p05", 
                              "speaker6" = "p06",
                              "speaker7" = "p07",
                              "speaker8" = "p08"))

slider_speaker_plot1 <- exp2_data_slider_final %>%
  ggplot(aes(x=factor(dimension, level = c('age', 'gender', 'education', 'accent')), y=slider_response, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(width = 0.3) +
    theme(legend.position="none") +
    xlab("Rating dimension") +
    ylab("Slider response") +
  facet_wrap(~speaker)

slider_speaker_plot1 
```

We can look at specific summary statistics here.

```{r}
#we can see the group means for certain factors
exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("cc","ss", "cs", "sc") & dimension == "age" & speaker == "speaker1") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("ii","rr", "ir", "ri") & dimension == "age"  & speaker == "speaker1") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("cc","ss", "cs", "sc") & dimension == "age" & speaker == "speaker8") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("ii","rr", "ir", "ri") & dimension == "age"  & speaker == "speaker8") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("cc","rr", "cr", "rc") & dimension == "gender" & speaker == "speaker1") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("ii","ss", "is", "ss") & dimension == "gender" & speaker == "speaker1") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("cc","rr", "cr", "rc") & dimension == "gender" & speaker == "speaker8") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("ii","ss", "is", "ss") & dimension == "gender" & speaker == "speaker8") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("cc","ss", "cs", "sc") & dimension == "education" & speaker == "speaker1") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("ii","rr", "ir", "ri") & dimension == "education") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("cc","ss", "cs", "sc") & dimension == "accent") %>%
  summarise(slider_mean = mean(values_for_plotting))

exp2_data_slider_final %>%
  filter(v_types_shorthand %in% c("ii","rr", "ir", "ri") & dimension == "accent") %>%
  summarise(slider_mean = mean(values_for_plotting))
```

```{r}
#TRAPTRAP plot
slider_speaker_plot_TRAPTRAP_age <- exp2_data_slider_final %>%
  filter(dimension == "age") %>%
  filter(v_types_shorthand %in% c("cc", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot() +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("AGE") +
    guides(fill="none") +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
    facet_grid(cols=vars(speaker))

slider_speaker_plot_TRAPTRAP_age 

slider_speaker_plot_TRAPTRAP_gender <- exp2_data_slider_final %>%
  filter(dimension == "gender") %>%
  filter(v_types_shorthand %in% c("cc", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#7CAE00") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("GENDER") +
    guides(fill="none") +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
    facet_grid(cols=vars(speaker))

slider_speaker_plot_TRAPTRAP_gender

slider_speaker_plot_TRAPTRAP_education <- exp2_data_slider_final %>%
  filter(dimension == "education") %>%
  filter(v_types_shorthand %in% c("cc", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#00BFC4") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("EDUCATION") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
    facet_grid(cols=vars(speaker))

slider_speaker_plot_TRAPTRAP_education

slider_speaker_plot_TRAPTRAP_accent <- exp2_data_slider_final %>%
  filter(dimension == "accent") %>%
  filter(v_types_shorthand %in% c("cc", "ii")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#C77CFF") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("ACCENT") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
    facet_grid(cols=vars(speaker))

slider_speaker_plot_TRAPTRAP_accent

TRAPTRAP_slider_speakers_plot <- (slider_speaker_plot_TRAPTRAP_age + slider_speaker_plot_TRAPTRAP_gender) / (slider_speaker_plot_TRAPTRAP_education + slider_speaker_plot_TRAPTRAP_accent)

TRAPTRAP_slider_speakers_plot + plot_annotation(
  title = "Boxplot of slider responses to TRAP-TRAP stimuli for each speaker"
)

```

```{r}
#TRAPt plot
slider_speaker_plot_TRAPt_age <- exp2_data_slider_final %>%
  filter(dimension == "age") %>%
  filter(v_types_shorthand %in% c("cs", "ir")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot() +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("AGE") +
    guides(fill="none") +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
    facet_grid(cols=vars(speaker))

slider_speaker_plot_TRAPt_age 

slider_speaker_plot_TRAPt_gender <- exp2_data_slider_final %>%
  filter(dimension == "gender") %>%
  filter(v_types_shorthand %in% c("cr", "is")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#7CAE00") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("GENDER") +
    guides(fill="none") +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
    facet_grid(cols=vars(speaker))

slider_speaker_plot_TRAPt_gender

slider_speaker_plot_TRAPt_education <- exp2_data_slider_final %>%
  filter(dimension == "education") %>%
  filter(v_types_shorthand %in% c("cs", "ir")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#00BFC4") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("EDUCATION") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
    facet_grid(cols=vars(speaker))

slider_speaker_plot_TRAPt_education

slider_speaker_plot_TRAPt_accent <- exp2_data_slider_final %>%
  filter(dimension == "accent") %>%
  filter(v_types_shorthand %in% c("cs", "ir")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#C77CFF") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("ACCENT") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
    facet_grid(cols=vars(speaker))

slider_speaker_plot_TRAPt_accent

TRAPt_slider_speakers_plot <- (slider_speaker_plot_TRAPt_age + slider_speaker_plot_TRAPt_gender) / (slider_speaker_plot_TRAPt_education + slider_speaker_plot_TRAPt_accent)

TRAPt_slider_speakers_plot + plot_annotation(
  title = "Boxplot of slider responses to TRAP-t stimuli for each speaker"
)

```

```{r}
#TRAPt plot
slider_speaker_plot_tTRAP_age <- exp2_data_slider_final %>%
  filter(dimension == "age") %>%
  filter(v_types_shorthand %in% c("sc", "ri")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("sc", "ri"))) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot() +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("AGE") +
    guides(fill="none") +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
    facet_grid(cols=vars(speaker))

slider_speaker_plot_tTRAP_age 

slider_speaker_plot_tTRAP_gender <- exp2_data_slider_final %>%
  filter(dimension == "gender") %>%
  filter(v_types_shorthand %in% c("rc", "si")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#7CAE00") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("GENDER") +
    guides(fill="none") +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
    facet_grid(cols=vars(speaker))

slider_speaker_plot_tTRAP_gender

slider_speaker_plot_tTRAP_education <- exp2_data_slider_final %>%
  filter(dimension == "education") %>%
  filter(v_types_shorthand %in% c("sc", "ri")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("sc", "ri"))) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#00BFC4") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("EDUCATION") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
    facet_grid(cols=vars(speaker))

slider_speaker_plot_tTRAP_education

slider_speaker_plot_tTRAP_accent <- exp2_data_slider_final %>%
  filter(dimension == "accent") %>%
  filter(v_types_shorthand %in% c("sc", "ri")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("sc", "ri"))) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#C77CFF") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("ACCENT") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
    facet_grid(cols=vars(speaker))

slider_speaker_plot_tTRAP_accent

tTRAP_slider_speakers_plot <- (slider_speaker_plot_tTRAP_age + slider_speaker_plot_tTRAP_gender) / (slider_speaker_plot_tTRAP_education + slider_speaker_plot_tTRAP_accent)

tTRAP_slider_speakers_plot + plot_annotation(
  title = "Boxplot of slider responses to TRAP-t stimuli for each speaker"
)

```

```{r}
#TRAPt plot
slider_speaker_plot_tt_age <- exp2_data_slider_final %>%
  filter(dimension == "age") %>%
  filter(v_types_shorthand %in% c("ss", "rr")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("ss", "rr"))) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot() +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("AGE") +
    guides(fill="none") +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
    facet_grid(cols=vars(speaker))

slider_speaker_plot_tt_age 

slider_speaker_plot_tt_gender <- exp2_data_slider_final %>%
  filter(dimension == "gender") %>%
  filter(v_types_shorthand %in% c("rr", "ss")) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#7CAE00") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("GENDER") +
    guides(fill="none") +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
    facet_grid(cols=vars(speaker))

slider_speaker_plot_tt_gender

slider_speaker_plot_tt_education <- exp2_data_slider_final %>%
  filter(dimension == "education") %>%
  filter(v_types_shorthand %in% c("ss", "rr")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("ss", "rr"))) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#00BFC4") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("EDUCATION") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
    facet_grid(cols=vars(speaker))

slider_speaker_plot_tt_education

slider_speaker_plot_tt_accent <- exp2_data_slider_final %>%
  filter(dimension == "accent") %>%
  filter(v_types_shorthand %in% c("ss", "rr")) %>%
  mutate(v_types_shorthand = factor(v_types_shorthand, levels=c("ss", "rr"))) %>%
  ggplot(aes(x=v_types_shorthand, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(fill="#C77CFF") +
    theme(legend.position="none") +
    xlab("Manipulation pair") +
    ylab("Slider response") +
    ggtitle("ACCENT") +
    guides(fill="none") +
    ylim(0.00, 1.5) +
    scale_y_continuous(breaks = c(0.0, 0.5, 1.0)) +
    theme_gray() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
    facet_grid(cols=vars(speaker))

slider_speaker_plot_tt_accent

tt_slider_speakers_plot <- (slider_speaker_plot_tt_age + slider_speaker_plot_tt_gender) / (slider_speaker_plot_tt_education + slider_speaker_plot_tt_accent)

tt_slider_speakers_plot + plot_annotation(
  title = "Boxplot of slider responses to t-t stimuli for each speaker"
)

```

```{r, eval=FALSE}
ggsave(plot = TRAPTRAP_slider_speakers_plot, here("plots", "vowel_and_t", "exp2_TRAPTRAP_slider_speakers_plot.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = TRAPt_slider_speakers_plot, here("plots", "vowel_and_t", "exp2_TRAPt_slider_speakers_plot.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = tTRAP_slider_speakers_plot, here("plots", "vowel_and_t", "exp2_tTRAP_slider_speakers_plot.png"), width = 9, height = 6, dpi = 400)
ggsave(plot = tt_slider_speakers_plot, here("plots", "vowel_and_t", "exp2_tt_slider_speakers_plot.png"), width = 9, height = 6, dpi = 400)
```

### Free text comments

The free text comments from the first experiment were quite insightful
and helped to interpret the results. The same is done below for the
second experiment.

```{r}
exp2_all_participant_comments <- exp2_participant_data_information %>%
  select(experiment, response, FreeText) %>%
  unique()

exp2_all_participant_comments <- exp2_all_participant_comments %>%
  filter(!FreeText == "NA") %>%
  filter(!FreeText == "")

print(exp2_all_participant_comments) #17 comments

#let's only keep the relevant comments
exp2_all_participant_comments_filtered <- exp2_all_participant_comments %>%
  filter(!experiment %in% c("exp120", "exp134", "exp42", "exp101", "exp109", "exp49"))

print(exp2_all_participant_comments_filtered)

```

I think there are a couple of comments worth delving into (exp250
(binary), exp79 (slider)).

exp250 - comment: "The *types of words* used made it seem more
masculine... Dotty cotton *more feminine* sounding"

This is an interesting comment! It somewhat aligns with H3 for the
vowels-only experiment where KIT was always rated as 'older' and 'more
masculine' regardless of it's formant values. This suggest that there
could be some effect of the 'age and gender' of the words themselves,
which has been found in the literature. We can look at this a bit
further by extracting the random intercepts for the two gender models
and seeing whether some words are always rated as 'less masculine/more
masculine'

```{r}
ranef_binary_gender <-
  ranef(exp2_binary_model_gender) %>% 
  as.data.frame() %>%
  mutate(task = "binary")

ranef_slider_gender <-
  ranef(exp2_slider_model_gender) %>% 
  as.data.frame() %>%
  mutate(task = "slider")

ranef_binary_gender %>%
  filter(grpvar == "word_pair") %>%
  arrange(desc(condval))

ranef_slider_gender %>%
  filter(grpvar == "word_pair") %>%
  arrange(desc(condval))
```

We can plot this and see whether any patterns emerge

```{r}
ranef_binary_plot <- ranef_binary_gender %>%
  filter(grpvar == "word_pair") %>%
  ggplot(aes(x=condval, y= condsd)) +
  geom_point(size = 0) +
  geom_text_repel(
    aes(label=grp),
    size = 3.75,
    force = 0.5,      
    box.padding = 0.1,
    max.overlaps = Inf,     
    seed = 42               
  ) +
  xlim(-0.3, 0.3)+
  ggtitle("binary task") +
  theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
  annotate("text", x = -0.27, y = 0.17, label = "less masculine", size = 3.5, colour="red", fontface="bold") +
  annotate("text", x = 0.27, y = 0.17, label = "more masculine", size = 3.5, colour="red", fontface="bold")

ranef_binary_plot

ranef_slider_plot <- ranef_slider_gender %>%
  filter(grpvar == "word_pair") %>%
  ggplot(aes(x=condval, y= condsd)) +
  geom_point(size = 0) +
  geom_text_repel(
    aes(label=grp),
    size = 3.75,
    force = 0.5,      
    box.padding = 0.1,
    max.overlaps = Inf,     
    seed = 42               
  ) +
  xlim(-0.03, 0.03) +
  ggtitle("slider task") +
  theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
  annotate("text", x = -0.027, y = 0.013, label = "less masculine", size = 3.5, colour="red", fontface="bold") +
  annotate("text", x = 0.027, y = 0.013, label = "more masculine", size = 3.5, colour="red", fontface="bold")

ranef_slider_plot

ranef_wordpair_plots <- ranef_binary_plot + ranef_slider_plot

ranef_wordpair_plots
```

Let's put the binary and slider data on the same plot with binary as the
y-axis and slider as the x-axis

```{r}
ranef_both_tasks_gender <- ranef_binary_gender %>%
  rename("binary_condval" = "condval",
         "binary_condsd" = "condsd") %>%
  filter(grpvar == "word_pair") %>%
  select(grp, binary_condval, binary_condsd)

ranef_slider_gender_interim <- ranef_slider_gender %>%
  rename("slider_condval" = "condval",
         "slider_condsd" = "condsd") %>%
  filter(grpvar == "word_pair") %>%
  select(grp, slider_condval, slider_condsd)

ranef_both_tasks_gender <- left_join(
  ranef_both_tasks_gender,
  ranef_slider_gender_interim,
  by = "grp"
)

rm(ranef_slider_gender_interim)

#we can highlight the high sd words in the plot 
ranef_both_tasks_gender$highlight <- 
ifelse(ranef_both_tasks_gender$grp %in% c("daggerparty", "dappercabin", "baggygarter", "baggybottom"), 
                      "highlight", "normal")

ranef_both_tasks_plot <- ranef_both_tasks_gender %>%
  ggplot(aes(x=slider_condval, y=binary_condval)) +
  geom_point(size = 0) +
  geom_text_repel(
    aes(label=grp, colour=highlight),
    size = 3.75,
    force = 0.5,      
    box.padding = 0.1,
    max.overlaps = Inf,     
    seed = 42               
  ) +
  xlab("slider model\n random effect estimates") +
  ylab("binary model\n random effect estimates") +
  scale_color_manual(values = c("highlight" = "#7CAE00", "normal" = "black")) +
  theme(legend.position = "none") +
  geom_smooth(method='lm', alpha = 0.3) +
  #ggtitle("slider task") +
  #theme(plot.title = element_text(hjust = 0.5, face = "bold")) 
  annotate("text", x = -0.0197, y = -0.29, label = "less masculine", size = 5, colour="red", fontface="bold") +
  annotate("text", x = 0.016, y = 0.31, label = "more masculine", size = 5, colour="red", fontface="bold")

ranef_both_tasks_plot

cor.test(ranef_both_tasks_gender$binary_condval, ranef_both_tasks_gender$slider_condval, method = "pearson")

```

Let's save this plot

```{r, eval=FALSE}
ggsave(plot = ranef_both_tasks_plot, here("plots", "vowel_and_t", "ranef_both_tasks_plot.png"), width = 9, height = 6, dpi = 600)
```

exp79 - comment: "age questions - they all sounded about my age
*(mid-twenties)* and very few sounded older or younger than each other!
NZ accent questions - if there were some other accents there to compare
it might've helped? nearly all of them just sounded like *pure definite
NZ accents to me*. Masculinity questions - I was primarily listening to
*pitch, with a bit of tone*. Finally, when the vowels didn't match
across the pairs of words (e.g. *larger parka with a broad first /a/ and
cultivated second /a/)* it really threw me, I found it sounded *too
artificial*."

```{r}
exp79_plot <- exp2_data_slider_final %>%
  filter(participant == "exp79") %>%
  ggplot(aes(x=factor(dimension, level = c('age', 'gender', 'education', 'accent')), y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(width = 0.3) +
    theme(legend.position="none") +
    xlab("Rating dimension") +
    ylab("Slider response") +
    ggtitle("Boxplot of slider responses from participant 79")
  #facet_wrap(~speaker)

exp79_plot

exp79_plot2 <- exp2_data_slider_final %>%
  filter(participant == "exp79") %>%
  mutate(dimension = factor(dimension, levels=c("age", "gender", "education", "accent"))) %>%
  ggplot(aes(x=dimension, y=values_for_plotting, fill=dimension)) + 
    #geom_violin() +
    geom_boxplot(width = 0.3) +
    theme(legend.position="none") +
    xlab("Rating dimension") +
    ylab("Slider response") +
    ggtitle("Boxplot of slider responses for each speaker from participant 79") +
    facet_wrap(~speaker)

exp79_plot2

```

```{r, eval=FALSE}
ggsave(plot = exp79_plot2, here("plots", "vowel_and_t", "exp2_participant79_plot2.png"), width = 9, height = 6, dpi = 400)
```

### Pitch analysis

Like the first experiment, we have reason to believe that pitch is the
variable being used to construct social meaning for age and gender, but
unlikely to be the variable constructing social meaning for education
and accent. To test this, we can add pitch into the models and see
whether it comes out as significance ( which we think should for age and
gender but not for education and accent) and if it changes the results
of the hypothesis tests (which we expect it won't).

We use the same `tidy_f0_summary2` dataframe we made in experiment 1
which gives the means of the original recordings for the six speakers.
As a reminder, speaker1 has the lowest mean pitch (95.25652Hz) while
speaker8 has the highest mean pitch (137.39230). Let's do all the binary
models first and then the slider models.

#### Binary age model

```{r}
exp2_data_binary_final_age_pitch <- left_join(
  exp2_data_binary_final_age,
  tidy_f0_summary2,
  by="stimulus_voice"
)

#we will need to rescale the pitch variables
exp2_data_binary_final_age_pitch <- exp2_data_binary_final_age_pitch %>%
  mutate(mean_pitch_scaled = scale(mean_pitch, center=T, scale=T)[,1])

print(exp2_data_binary_final_age_pitch)

exp2_binary_model_age_pitch <- glmer(
  binary_response_numeric ~ variable_same * manipulation_matching * v1_type * variable_1 * mean_pitch_scaled + (1|participant) + (1|stimulus_voice),
  family = binomial, #removed block and word pair as random effects because of singular fit issue
  data = exp2_data_binary_final_age_pitch,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)) #does not converge without optimisation control
)

summary(exp2_binary_model_age_pitch)
```

We can see if controlling for pitch changes the hypothesis tests

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  exp2_binary_model_age_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 is still not significant.

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  exp2_binary_model_age_pitch,
  variables = "variable_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(-0.01, 0.01),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "variable_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H2 remains not significant.

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  exp2_binary_model_age_pitch,
  variables = "variable_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H3 remains not significant.

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  exp2_binary_model_age_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = FALSE,
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H4 remains not significant.

#### Binary gender model

```{r}
exp2_data_binary_final_gender_pitch <- left_join(
  exp2_data_binary_final_gender,
  tidy_f0_summary2,
  by="stimulus_voice"
)

#we will need to rescale the pitch variables
exp2_data_binary_final_gender_pitch <- exp2_data_binary_final_gender_pitch %>%
  mutate(mean_pitch_scaled = scale(mean_pitch, center=T, scale=T)[,1])

print(exp2_data_binary_final_gender_pitch)

exp2_binary_model_gender_pitch <- glmer(
  binary_response_numeric ~ variable_same * manipulation_matching * v1_type * variable_1 * mean_pitch_scaled + (1|participant) + (1|word_pair) + (1|stimulus_voice), #removed block for singular fit issue
  family = binomial,
  data = exp2_data_binary_final_gender_pitch,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)) #needs control
)

summary(exp2_binary_model_gender_pitch)
```

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  exp2_binary_model_gender_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 remains not significant (but is close for row 2)!

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  exp2_binary_model_gender_pitch,
  variables = "variable_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(-0.01, 0.01),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "variable_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H2 remains not significant

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  exp2_binary_model_gender_pitch,
  variables = "variable_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H3 remains not significant.

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  exp2_binary_model_gender_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = FALSE,
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H4 remains significant.

#### Binary education model

```{r}
exp2_data_binary_final_education_pitch <- left_join(
  exp2_data_binary_final_education,
  tidy_f0_summary2,
  by="stimulus_voice"
)

#we will need to rescale the pitch variables
exp2_data_binary_final_education_pitch <- exp2_data_binary_final_education_pitch %>%
  mutate(mean_pitch_scaled = scale(mean_pitch, center=T, scale=T)[,1])

print(exp2_data_binary_final_education_pitch)

exp2_binary_model_education_pitch <- glmer(
  binary_response_numeric ~ variable_same * manipulation_matching * v1_type * variable_1 * mean_pitch_scaled + (1|participant) + (1|word_pair) + (1|stimulus_voice), #removed block for singular fit warning
  family = binomial,
  data = exp2_data_binary_final_education_pitch,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)) #needs control
)

summary(exp2_binary_model_education_pitch)
```

Interestingly, pitch is significant here (p\<0.001)

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  exp2_binary_model_education_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 remains significant

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  exp2_binary_model_education_pitch,
  variables = "variable_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(-0.01, 0.01),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "variable_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H2 remains not significant.

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  exp2_binary_model_education_pitch,
  variables = "variable_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H3 does not change. Listeners more likely to rate the speaker as 'more
well educated' for ss stimuli than cc stimuli.

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  exp2_binary_model_education_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = FALSE,
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H4 remains is significant here.

#### Binary accent model

```{r}
exp2_data_binary_final_accent_pitch <- left_join(
  exp2_data_binary_final_accent,
  tidy_f0_summary2,
  by="stimulus_voice"
)

#we will need to rescale the pitch variables
exp2_data_binary_final_accent_pitch <- exp2_data_binary_final_accent_pitch %>%
  mutate(mean_pitch_scaled = scale(mean_pitch, center=T, scale=T)[,1])

print(exp2_data_binary_final_accent_pitch)

exp2_binary_model_accent_pitch <- glmer(
  binary_response_numeric ~ variable_same * manipulation_matching * v1_type * variable_1 * mean_pitch_scaled + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  family = binomial,
  data = exp2_data_binary_final_accent_pitch,
  control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)) #needs control
)

summary(exp2_binary_model_accent_pitch)
```

Pitch is close to significance here but not quite!

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  exp2_binary_model_accent_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 remains significant

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  exp2_binary_model_accent_pitch,
  variables = "variable_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(-0.01, 0.01),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "variable_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H2 remains not significant

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  exp2_binary_model_accent_pitch,
  variables = "variable_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H3 remains not significant.

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  exp2_binary_model_accent_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = FALSE,
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H4 remaisn not significant.

Great. So pitch is mostly doing as predicted, but is surprisingly
significant in the education model. This actually matches one of the
participant's comments (exp185):

"Maybe 1-2 more different voices. For well educated, it came off more
*bored/disinterested than uneducated*."

Last thing to do now is look at the slider models with pitch.

#### Slider age model

```{r}
exp2_data_slider_final_age_pitch <- left_join(
  exp2_data_slider_final_age,
  tidy_f0_summary2,
  by="stimulus_voice"
)

#we will need to rescale the pitch variables
exp2_data_slider_final_age_pitch <- exp2_data_slider_final_age_pitch %>%
  mutate(mean_pitch_scaled = scale(mean_pitch, center=T, scale=T)[,1])

print(exp2_data_slider_final_age_pitch)

exp2_slider_model_age_pitch <- lmer(
  slider_response ~ variable_same * manipulation_matching * v1_type * variable_1 * mean_pitch_scaled + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp2_data_slider_final_age_pitch,
) 

summary(exp2_slider_model_age_pitch)
```

Pitch most significant - as predicted.

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  exp2_slider_model_age_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 remains not significant.

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  exp2_slider_model_age_pitch,
  variables = "variable_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(-0.01, 0.01),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "variable_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H2 remains not significant

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  exp2_slider_model_age_pitch,
  variables = "variable_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H3 does not change. Listeners more likely to rate the speaker as 'more
well educated' for ss stimuli than cc stimuli.

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  exp2_slider_model_age_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = FALSE,
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H4 remains not significant.

#### Slider gender model

```{r}
exp2_data_slider_final_gender_pitch <- left_join(
  exp2_data_slider_final_gender,
  tidy_f0_summary2,
  by="stimulus_voice"
)

#we will need to rescale the pitch variables
exp2_data_slider_final_gender_pitch <- exp2_data_slider_final_gender_pitch %>%
  mutate(mean_pitch_scaled = scale(mean_pitch, center=T, scale=T)[,1])

print(exp2_data_slider_final_gender_pitch)

exp2_slider_model_gender_pitch <- lmer(
  slider_response ~ variable_same * manipulation_matching * v1_type * variable_1 * mean_pitch_scaled + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp2_data_slider_final_gender_pitch #removed block
)

summary(exp2_slider_model_gender_pitch)
```

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  exp2_slider_model_gender_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 remains not significant

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  exp2_slider_model_gender_pitch,
  variables = "variable_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(-0.01, 0.01),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "variable_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H2 remains not significant.

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  exp2_slider_model_gender_pitch,
  variables = "variable_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H3 remains not significant.

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  exp2_slider_model_gender_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = FALSE,
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H4 remains not significant.

#### Slider education model

```{r}
exp2_data_slider_final_education_pitch <- left_join(
  exp2_data_slider_final_education,
  tidy_f0_summary2,
  by="stimulus_voice"
)

#we will need to rescale the pitch variables
exp2_data_slider_final_education_pitch <- exp2_data_slider_final_education_pitch %>%
  mutate(mean_pitch_scaled = scale(mean_pitch, center=T, scale=T)[,1])

print(exp2_data_slider_final_education_pitch)

exp2_slider_model_education_pitch <- lmer(
  slider_response ~ variable_same * manipulation_matching * v1_type * variable_1 * mean_pitch_scaled + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp2_data_slider_final_education_pitch
)

summary(exp2_slider_model_education_pitch)
```

Pitch also reaches significance for education ratings here (not as
strong as other variables, but still significant).

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  exp2_slider_model_education_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 remains significant

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  exp2_slider_model_education_pitch,
  variables = "variable_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(-0.01, 0.01),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "variable_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H2 remains not significant (close for ii stimuli).

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  exp2_slider_model_education_pitch,
  variables = "variable_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H3 remains not significant (close to significance for cc).

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  exp2_slider_model_education_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = FALSE,
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 remains not significant.

#### Slider accent model

```{r}
exp2_data_slider_final_accent_pitch <- left_join(
  exp2_data_slider_final_accent,
  tidy_f0_summary2,
  by="stimulus_voice"
)

#we will need to rescale the pitch variables
exp2_data_slider_final_accent_pitch <- exp2_data_slider_final_accent_pitch %>%
  mutate(mean_pitch_scaled = scale(mean_pitch, center=T, scale=T)[,1])

print(exp2_data_slider_final_accent_pitch)

exp2_slider_model_accent_pitch <- lmer(
  slider_response_inverse ~ variable_same * manipulation_matching * v1_type * variable_1 * mean_pitch_scaled + (1|block) + (1|participant) + (1|word_pair) + (1|stimulus_voice),
  data = exp2_data_slider_final_accent_pitch
) #using the inverse data here

summary(exp2_slider_model_accent_pitch)
```

Pitch reaches significance here!

H1: Social meaning in isolation

a)  KKii \< KKcc

b)  TTii \< TTcc

```{r}
comparisons(
  exp2_slider_model_accent_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H1 remains significant.

H2: Different variables vs repetition of same variables

a)  VDcc \> VScc

b)  VDii \< VSii

```{r}
avg_comparisons(
  exp2_slider_model_accent_pitch,
  variables = "variable_same",
  by = "v1_type",
  hypothesis = 0,
  equivalence = c(-0.01, 0.01),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_1" = c("TRAP", "t"),
    "variable_same" = c(TRUE, FALSE),
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H2 remains not significant.

H3: Relative salience of variables

a)  KKcc != TTcc

b)  KKii != TTii

```{r}
comparisons(
  exp2_slider_model_accent_pitch,
  variables = "variable_1",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = TRUE,
    "variable_same" = TRUE,
    "v1_type" = c("Innovative", "Conservative"),
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H3 remains not significant.

H4: Order of presentation

a)  ic \< ci

```{r}
comparisons(
  exp2_slider_model_accent_pitch,
  variables = "v1_type",
  hypothesis = 0,
  equivalence = c(0, 0),
  newdata = datagrid(
    "manipulation_matching" = FALSE,
    "mean_pitch_scaled" = 0
  ),
  re.form = NA
)
```

H4 remains not significant.
